Screens:
  ApprovalHistoryScreen:
    Properties:
      Fill: =Colors.BackgroundLight
      OnVisible: "=// Load SharePoint data với mapping chính xác\nIfError(\n  // Load main NamecardRequest data\n  ClearCollect(colApprovalHistoryRaw, NamecardRequest_1);\n  \n  // Tạo collection với mapping đúng fields SharePoint\n  ClearCollect(colApprovalHistory,\n    AddColumns(\n      AddColumns(\n        AddColumns(\n          colApprovalHistoryRaw,\n          EmployeeName, LookUp(User_1, userID = ThisRecord.userID).fullname\n        ),\n        Department, LookUp(Department_1, departmentID = LookUp(User_1, userID = ThisRecord.userID).departmentID.Value).name\n      ),\n      RequestCode, \"REQ-\" & Text(ThisRecord.requestID, \"000000\")\n    )\n  ),\n  // Fallback nếu SharePoint fails\n  ClearCollect(colApprovalHistory, Table())\n);\nSet(varCurrentUser, {FullName: \"Trần Thị Bình\", Role: \"Manager\", Department: \"Phòng Công nghệ thông tin\"});\nSet(varSelectedApproval, Blank());\nSet(varShowApprovalDetails, false);\nSet(varFilterStatus, \"All\");\nSet(varFilterPriority, \"All\");\nSet(varDateFrom, Blank());\nSet(varDateTo, Blank());\nSet(varSearchEmployee, \"\");\nUpdateContext({\n  summaryStats: {\n    TotalRequests: CountRows(colApprovalHistory),\n    PendingApprovals: CountRows(Filter(colApprovalHistory, status.Value in [\"PendingManagerApproval\", \"PendingHRApproval\"])),\n    ApprovedRequests: CountRows(Filter(colApprovalHistory, status.Value = \"Approved\")),\n    RejectedRequests: CountRows(Filter(colApprovalHistory, status.Value = \"Rejected\"))\n  }\n})\n"
    Children:
      - Main.Content.Container_4:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Fill: =Colors.BackgroundLight
            Height: =Parent.Height - Styles.Header.Height
            Width: =Parent.Width - Styles.Navigation.Width
            X: =Styles.Navigation.Width
            Y: =Styles.Header.Height
          Children:
            - Page.Header.Section_4:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.White
                  Height: =Parent.Height * 0.12
                  Width: =Parent.Width
                Children:
                  - Page.Title_4:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.TextPrimary
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height * 0.35
                        Size: =FontSizes.XLarge
                        Text: ="Lịch sử phê duyệt"
                        Width: =Parent.Width * 0.5
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.15
                  - Page.Subtitle_3:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.TextMuted
                        Height: =Parent.Height * 0.35
                        Size: =FontSizes.Base
                        Text: ="Theo dõi và quản lý quá trình phê duyệt yêu cầu thẻ tên"
                        Width: =Parent.Width * 0.5
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.5
            - Summary.Stats.Section_1:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.BackgroundLight
                  Height: =Parent.Height * 0.18
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.12
                Children:
                  - Total.Requests.Card_3:
                      Control: CanvasComponent
                      ComponentName: StatsCardComponent
                      Properties:
                        BorderColor: =Colors.Primary
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height * 0.8
                        IsClickable: =true
                        IsLoading: =false
                        Title: ="Tổng yêu cầu"
                        Value: =Text(summaryStats.TotalRequests)
                        ValueColor: =Colors.Primary
                        Width: =Parent.Width * 0.22
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.1
                  - Pending.Approvals.Card_1:
                      Control: CanvasComponent
                      ComponentName: StatsCardComponent
                      Properties:
                        BorderColor: =Colors.Warning
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height * 0.8
                        IsClickable: =true
                        IsLoading: =false
                        Title: ="Chờ phê duyệt"
                        Value: =Text(summaryStats.PendingApprovals)
                        ValueColor: =Colors.Warning
                        Width: =Parent.Width * 0.22
                        X: =Parent.Width * 0.27
                        Y: =Parent.Height * 0.1
                  - Approved.Requests.Card_3:
                      Control: CanvasComponent
                      ComponentName: StatsCardComponent
                      Properties:
                        BorderColor: =Colors.Success
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height * 0.8
                        IsClickable: =true
                        IsLoading: =false
                        Title: ="Đã phê duyệt"
                        Value: =Text(summaryStats.ApprovedRequests)
                        ValueColor: =Colors.Success
                        Width: =Parent.Width * 0.22
                        X: =Parent.Width * 0.51
                        Y: =Parent.Height * 0.1
                  - Rejected.Requests.Card_3:
                      Control: CanvasComponent
                      ComponentName: StatsCardComponent
                      Properties:
                        BorderColor: =Colors.Error
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height * 0.8
                        IsClickable: =true
                        IsLoading: =false
                        Title: ="Bị từ chối"
                        Value: =Text(summaryStats.RejectedRequests)
                        ValueColor: =Colors.Error
                        Width: =Parent.Width * 0.22
                        X: =Parent.Width * 0.75
                        Y: =Parent.Height * 0.1
            - Filters.Section_1:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.White
                  Height: =Parent.Height * 0.12
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.3
                Children:
                  - Filters.Title_2:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.TextPrimary
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height * 0.3
                        Size: =FontSizes.Medium
                        Text: ="Bộ lọc"
                        Width: =Parent.Width * 0.2
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.1
                  - Status.Filter_3:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Colors.Border
                        DefaultSelectedItems: |
                          =Table({Name: "Tất cả", Value: "All"})
                        Fill: =Colors.White
                        Height: =Styles.Input.Height
                        Items: |
                          =Table(
                          {Name: "Tất cả", Value: "All"},
                          {Name: "Chờ duyệt", Value: "Pending"},
                          {Name: "Đã duyệt", Value: "Approved"},
                          {Name: "Từ chối", Value: "Rejected"},
                          {Name: "Đã in", Value: "Printed"},
                          {Name: "Đã phát", Value: "Distributed"}
                          )
                        OnChange: |
                          =Set(varFilterStatus, Self.Selected.Value)
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.5
                  - Priority.Filter_2:
                      Control: DropDown@0.0.45
                      Properties:
                        BorderColor: =Colors.Border
                        DefaultSelectedItems: |
                          =Table({Name: "Tất cả", Value: "All"})
                        Fill: =Colors.White
                        Height: =Styles.Input.Height
                        Items: |
                          =Table(
                          {Name: "Tất cả", Value: "All"},
                          {Name: "Nhân viên mới", Value: "High"},
                          {Name: "Thay thế/Cập nhật", Value: "Normal"},
                          {Name: "Tạm thời", Value: "Low"}
                          )
                        OnChange: |
                          =Set(varFilterPriority, Self.Selected.Value)
                        Width: =Parent.Width * 0.12
                        X: =Parent.Width * 0.2
                        Y: =Parent.Height * 0.5
                  - Employee.Search_1:
                      Control: Classic/TextInput@2.3.2
                      Properties:
                        BorderColor: =Colors.Border
                        Color: =Colors.TextPrimary
                        Default: =""
                        Fill: =Colors.White
                        FocusedBorderColor: =Colors.Primary
                        Height: =Styles.Input.Height
                        HintText: ="Tìm kiếm nhân viên..."
                        OnChange: |
                          =Set(varSearchEmployee, Self.Text)
                        Size: =FontSizes.Small
                        Width: =Parent.Width * 0.2
                        X: =Parent.Width * 0.34
                        Y: =Parent.Height * 0.5
                  - Date.From.Label_2:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.TextPrimary
                        Height: =Parent.Height * 0.25
                        Size: =FontSizes.Small
                        Text: ="Từ ngày:"
                        Width: =Parent.Width * 0.08
                        X: =Parent.Width * 0.56
                        Y: =Parent.Height * 0.2
                  - Date.From.Input_2:
                      Control: Classic/DatePicker@2.6.0
                      Properties:
                        BorderColor: =Colors.Border
                        DefaultDate: =Blank()
                        Fill: =Colors.White
                        Height: =Styles.Input.Height
                        OnChange: |
                          =Set(varDateFrom, Self.SelectedDate)
                        Size: =FontSizes.Small
                        Width: =Parent.Width * 0.12
                        X: =Parent.Width * 0.56
                        Y: =Parent.Height * 0.5
                  - Date.To.Label_2:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.TextPrimary
                        Height: =Parent.Height * 0.25
                        Size: =FontSizes.Small
                        Text: ="Đến ngày:"
                        Width: =Parent.Width * 0.08
                        X: =Parent.Width * 0.7
                        Y: =Parent.Height * 0.2
                  - Date.To.Input_2:
                      Control: Classic/DatePicker@2.6.0
                      Properties:
                        BorderColor: =Colors.Border
                        DefaultDate: =Blank()
                        Fill: =Colors.White
                        Height: =Styles.Input.Height
                        OnChange: |
                          =Set(varDateTo, Self.SelectedDate)
                        Size: =FontSizes.Small
                        Width: =Parent.Width * 0.12
                        X: =Parent.Width * 0.7
                        Y: =Parent.Height * 0.5
                  - Clear.Filters.Button_3:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.Border
                        Color: =Styles.Button.Secondary.Color
                        Fill: =Styles.Button.Secondary.Fill
                        Height: =Styles.Input.Height
                        HoverFill: =Styles.Button.Secondary.HoverFill
                        OnSelect: |
                          =Reset('Status.Filter_3');
                          Reset('Priority.Filter_2');
                          Reset('Employee.Search_1');
                          Reset('Date.From.Input_2');
                          Reset('Date.To.Input_2');
                          Set(varFilterStatus, "All");
                          Set(varFilterPriority, "All");
                          Set(varSearchEmployee, "");
                          Set(varDateFrom, Blank());
                          Set(varDateTo, Blank())
                        Size: =FontSizes.Small
                        Text: ="Xóa bộ lọc"
                        Width: =Parent.Width * 0.12
                        X: =Parent.Width * 0.85
                        Y: =Parent.Height * 0.5
            - Approval.History.List.Section_1:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.BackgroundLight
                  Height: =Parent.Height * 0.58
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.42
                Children:
                  - History.Section.Title_1:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.TextPrimary
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height * 0.08
                        Size: =FontSizes.Large
                        Text: ="Danh sách lịch sử phê duyệt"
                        Width: =Parent.Width * 0.5
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.02
                  - DataTable.Selection.Handler_1:
                      Control: Rectangle@2.3.0
                      Properties:
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =416.44
                        OnSelect: |
                          =If(Not(IsBlank('Approval.History.DataTable'.Selected)),
                            Set(varSelectedApproval, 'Approval.History.DataTable'.Selected);
                            Set(varShowApprovalDetails, true)
                          )
                        Width: =1166
      - Approval.History.DataTable:
          Control: DataTable@1.0.3
          Properties:
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =Colors.TextPrimary
            Fill: =Colors.White
            Font: =Font.'Segoe UI'
            HeadingColor: =Colors.White
            HeadingFill: =Colors.Primary
            HeadingFont: =Font.'Segoe UI'
            Height: =352
            Items: |
              =Filter(colApprovalHistory,
                // Filter by status - sử dụng đúng SharePoint status values
                If(varFilterStatus = "All", true, 
                  If(varFilterStatus = "Pending", status.Value = "Chờ duyệt",
                    If(varFilterStatus = "Approved", status.Value = "Đã duyệt",
                      If(varFilterStatus = "Rejected", status.Value = "Từ chối", true)
                    )
                  )
                ) &&
                // Filter by suggestedReason (thay vì Priority)
                If(varFilterPriority = "All", true, 
                  If(varFilterPriority = "High", suggestedReason = "New Employee",
                    If(varFilterPriority = "Normal", suggestedReason in ["Replacement", "Update Info"],
                      If(varFilterPriority = "Low", suggestedReason = "Temporary", true)
                    )
                  )
                ) &&
                // Filter by employee name
                If(IsBlank(varSearchEmployee), true, 
                  EmployeeName in varSearchEmployee || 
                  StartsWith(Lower(EmployeeName), Lower(varSearchEmployee))
                ) &&
                // Filter by date range - sử dụng Created field thay vì RequestDate
                If(IsBlank(varDateFrom), true, DateValue(Created) >= varDateFrom) &&
                If(IsBlank(varDateTo), true, DateValue(Created) <= varDateTo)
              )
            Width: =1166
            X: =200
            Y: =415
          Children:
            - RequestCode.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Mã yêu cầu"
                  FieldName: ="RequestCode"
                  Order: =1
                  Text: =ThisItem.RequestCode
                  Width: =120
            - Employee.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Nhân viên"
                  FieldName: ="EmployeeName"
                  Order: =2
                  Text: =ThisItem.EmployeeName
                  Width: =180
            - CardType.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Lý do yêu cầu"
                  FieldName: ="suggestedReason"
                  Order: =3
                  Text: =ThisItem.suggestedReason
                  Width: =150
            - RequestDate.Column:
                Control: DataTableColumn@1.0.1
                Variant: DateTime
                Properties:
                  FieldDisplayName: ="Ngày tạo"
                  FieldName: ="Created"
                  Order: =4
                  Text: =Text(DateValue(ThisItem.Created), "dd/mm/yyyy")
                  Width: =120
            - Priority.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Số lượng"
                  FieldName: ="quantity"
                  Order: =5
                  Text: =Text(ThisItem.quantity)
                  Width: =80
            - Status.Column_1:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Trạng thái"
                  FieldName: ="status"
                  Order: =6
                  Text: =ThisItem.status.Value
                  Width: =120
      - Approval.Details.Modal.Overlay_1:
          Control: Rectangle@2.3.0
          Properties:
            Fill: =Styles.Modal.Overlay
            Height: =Parent.Height
            OnSelect: |
              =Set(varShowApprovalDetails, false)
            Visible: =varShowApprovalDetails
            Width: =Parent.Width
      - Approval.Details.Modal_1:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Fill: =Colors.White
            Height: =Parent.Height * 0.8
            Visible: =varShowApprovalDetails
            Width: =Parent.Width * 0.7
            X: =If(varShowApprovalDetails, (Parent.Width - Parent.Width * 0.7) / 2, -Parent.Width)
            Y: =If(varShowApprovalDetails, (Parent.Height - Parent.Height * 0.8) / 2, -Parent.Height)
          Children:
            - Details.Modal.Header_2:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.Primary
                  Height: =Parent.Height * 0.1
                  Width: =Parent.Width
                Children:
                  - Details.Modal.Title_2:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.White
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height
                        Size: =FontSizes.Large
                        Text: ="Chi tiết lịch sử phê duyệt"
                        Width: =Parent.Width * 0.8
                        X: =Parent.Width * 0.04
                  - Details.Modal.Close.Button_2:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.White
                        Color: =Colors.White
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height * 0.6
                        OnSelect: |
                          =Set(varShowApprovalDetails, false)
                        Size: =FontSizes.Large
                        Text: ="×"
                        Width: =Parent.Height * 0.6
                        X: =Parent.Width * 0.9
                        Y: =Parent.Height * 0.2
            - Details.Modal.Content_1:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.White
                  Height: =Parent.Height * 0.9
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.1
                Children:
                  - Request.Info.Section_1:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        BorderColor: =Colors.BorderLight
                        BorderThickness: =1
                        Fill: =Colors.BackgroundLight
                        Height: =Parent.Height * 0.25
                        Width: =Parent.Width * 0.94
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.02
                      Children:
                        - Info.Section.Title_1:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Bold
                              Height: =Parent.Height * 0.2
                              Size: =FontSizes.Medium
                              Text: ="Thông tin yêu cầu"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.03
                              Y: =Parent.Height * 0.05
                        - Request.Code.Detail_1:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              Height: =Parent.Height * 0.25
                              Size: =FontSizes.Small
                              Text: |
                                =Concatenate("Mã yêu cầu: ", varSelectedApproval.RequestCode)
                              Width: =Parent.Width * 0.23
                              X: =Parent.Width * 0.03
                              Y: =Parent.Height * 0.3
                        - Employee.Name.Detail_1:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              Height: =Parent.Height * 0.25
                              Size: =FontSizes.Small
                              Text: =Concatenate("Nhân viên:", varSelectedApproval.EmployeeName)
                              Width: =Parent.Width * 0.24
                              X: =Parent.Width * 0.26
                              Y: =Parent.Height * 0.3
                        - Card.Type.Detail_2:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              Height: =Parent.Height * 0.25
                              Size: =FontSizes.Small
                              Text: =Concatenate("Lý do:", varSelectedApproval.suggestedReason)
                              Width: =Parent.Width * 0.23
                              X: =Parent.Width * 0.5
                              Y: =Parent.Height * 0.3
                        - Priority.Detail_2:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              Height: =Parent.Height * 0.25
                              Size: =FontSizes.Small
                              Text: =Concatenate("Số lượng:", Text(varSelectedApproval.quantity))
                              Width: =Parent.Width * 0.24
                              X: =Parent.Width * 0.73
                              Y: =Parent.Height * 0.3
                        - Request.Date.Detail_2:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              Height: =Parent.Height * 0.25
                              Size: =FontSizes.Small
                              Text: =Concatenate("Ngày tạo:", Text(DateValue(varSelectedApproval.Created), "dd/mm/yyyy"))
                              Width: =Parent.Width * 0.23
                              X: =Parent.Width * 0.03
                              Y: =Parent.Height * 0.6
                        - Department.Detail_2:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              Height: =Parent.Height * 0.25
                              Size: =FontSizes.Small
                              Text: =Concatenate("Phòng ban:", varSelectedApproval.Department)
                              Width: =Parent.Width * 0.24
                              X: =Parent.Width * 0.26
                              Y: =Parent.Height * 0.6
                        - Current.Status.Detail_1:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              Height: =Parent.Height * 0.25
                              Size: =FontSizes.Small
                              Text: =Concatenate("Trạng thái:", varSelectedApproval.status)
                              Width: =Parent.Width * 0.47
                              X: =Parent.Width * 0.5
                              Y: =Parent.Height * 0.6
                        - Note.Detail_1:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              Height: =Parent.Height * 0.25
                              Size: =FontSizes.Small
                              Text: =If(IsBlank(varSelectedApproval.note), "Ghi chú:Không có", Concatenate("Ghi chú:", varSelectedApproval.note))
                              Width: =Parent.Width * 0.94
                              X: =Parent.Width * 0.03
                              Y: =Parent.Height * 0.85
                  - Approval.Timeline.Section_1:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =Colors.BackgroundLight
                        Height: =Parent.Height * 0.69
                        Width: =Parent.Width * 0.94
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.29
                      Children:
                        - Timeline.Section.Title_1:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Bold
                              Height: =Parent.Height * 0.08
                              Size: =FontSizes.Medium
                              Text: ="Timeline phê duyệt"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.03
                              Y: =Parent.Height * 0.02
                        - Approval.Steps.Gallery_1:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              Height: =Parent.Height * 0.86
                              Items: =varSelectedApproval.ApprovalSteps
                              TemplatePadding: =4
                              TemplateSize: =Parent.Height * 0.25
                              Width: =Parent.Width * 0.94
                              X: =Parent.Width * 0.03
                              Y: =Parent.Height * 0.12
                            Children:
                              - Step.Container_1:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    BorderColor: =Colors.BorderLight
                                    BorderThickness: =1
                                    Fill: =Colors.White
                                    Height: =Parent.TemplateHeight
                                    Width: =Parent.Width
                              - Step.Number.Circle_1:
                                  Control: GroupContainer@1.3.0
                                  Variant: ManualLayout
                                  Properties:
                                    Fill: |
                                      =Switch(ThisItem.Status,
                                        "Approved", Colors.Success,
                                        "Rejected", Colors.Error,
                                        "Pending", Colors.Warning,
                                        Colors.Border
                                      )
                                    Height: =Parent.Height * 0.6
                                    Width: =Parent.Height * 0.6
                                    X: =Parent.Width * 0.03
                                    Y: =Parent.Height * 0.2
                                  Children:
                                    - Step.Number.Text_1:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: =Colors.White
                                          FontWeight: =FontWeight.Bold
                                          Height: =Parent.Height
                                          Size: =FontSizes.Medium
                                          Text: =Text(ThisItem.Step)
                                          Width: =Parent.Width
                              - Step.Role.Label_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    FontWeight: =FontWeight.Bold
                                    Height: =Parent.Height * 0.3
                                    Size: =FontSizes.Small
                                    Text: =Concatenate("Bước ", Text(ThisItem.Step), ":", ThisItem.ApproverRole)
                                    Width: =Parent.Width * 0.2
                                    X: =Parent.Width * 0.12
                                    Y: =Parent.Height * 0.1
                              - Step.Approver.Name_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =If(IsBlank(ThisItem.ApproverName), Colors.TextMuted, Colors.TextPrimary)
                                    Height: =Parent.Height * 0.3
                                    Size: =FontSizes.Small
                                    Text: =If(IsBlank(ThisItem.ApproverName), "Chưa có người phê duyệt", ThisItem.ApproverName)
                                    Width: =Parent.Width * 0.2
                                    X: =Parent.Width * 0.32
                                    Y: =Parent.Height * 0.1
                              - Step.Approval.Date_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =If(IsBlank(ThisItem.ApprovalDate), Colors.TextMuted, Colors.TextPrimary)
                                    Height: =Parent.Height * 0.3
                                    Size: =FontSizes.Small
                                    Text: =If(IsBlank(ThisItem.ApprovalDate), "Chưa phê duyệt", Text(ThisItem.ApprovalDate, "dd/mm/yyyy"))
                                    Width: =Parent.Width * 0.15
                                    X: =Parent.Width * 0.52
                                    Y: =Parent.Height * 0.1
                              - Step.Status.Badge_1:
                                  Control: GroupContainer@1.3.0
                                  Variant: ManualLayout
                                  Properties:
                                    Fill: |
                                      =Switch(ThisItem.Status,
                                        "Approved", StatusColors.ApprovedBg,
                                        "Rejected", StatusColors.RejectedBg,
                                        "Pending", StatusColors.PendingBg,
                                        Colors.BorderLight
                                      )
                                    Height: =Parent.Height * 0.4
                                    Width: =Parent.Width * 0.12
                                    X: =Parent.Width * 0.67
                                    Y: =Parent.Height * 0.05
                                  Children:
                                    - Step.Status.Text_1:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: |
                                            =Switch(ThisItem.Status,
                                              "Approved", StatusColors.ApprovedText,
                                              "Rejected", StatusColors.RejectedText,
                                              "Pending", StatusColors.PendingText,
                                              Colors.TextMuted
                                            )
                                          FontWeight: =FontWeight.Semibold
                                          Height: =Parent.Height
                                          Size: =FontSizes.Small
                                          Text: |
                                            =Switch(ThisItem.Status,
                                              "Approved", "Đã duyệt",
                                              "Rejected", "Từ chối",
                                              "Pending", "Chờ duyệt",
                                              "Không rõ"
                                            )
                                          Width: =Parent.Width
                              - Step.Comments.Label_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height * 0.2
                                    Size: =FontSizes.Small
                                    Text: ="Nhận xét:"
                                    Width: =Parent.Width * 0.15
                                    X: =Parent.Width * 0.12
                                    Y: =Parent.Height * 0.45
                              - Step.Comments.Text_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =If(IsBlank(ThisItem.Comments), Colors.TextMuted, Colors.TextPrimary)
                                    Height: =Parent.Height * 0.3
                                    Size: =FontSizes.Small
                                    Text: =If(IsBlank(ThisItem.Comments), "Không có nhận xét", ThisItem.Comments)
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =Parent.Width * 0.85
                                    X: =Parent.Width * 0.12
                                    Y: =Parent.Height * 0.65
