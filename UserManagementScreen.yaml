Screens:
  UserManagementScreen:
    Properties:
      Fill: =Colors.BackgroundLight
      OnVisible: |
        =// Load SharePoint data first
        ClearCollect(colDepartments, Department_1);
        ClearCollect(colRoles, Role_1);
        ClearCollect(colUsers, 
          AddColumns(
            AddColumns(User_1, 
              Department, LookUp(Department_1, departmentID = ThisRecord.departmentID).name
            ),
            Role, LookUp(Role_1, roleID = LookUp(User_Role, userID = ThisRecord.userID).roleID).name
          )
        );
        // Reset form states
        Set(varShowUserForm, false);
        Set(varFormMode, "Add");
        Set(varEditingUser, Blank());
        Set(varSelectedUser, Blank());
        Set(varDeleteConfirm, false);
        Set(varLoadingUsers, false);
        Set(varErrorMessage, "");
        Set(varShowUserDetail, false);
        Set(varDetailFormMode, "View");
        Set(varShowContextMenu, false);
        Set(varContextMenuX, 0);
        Set(varContextMenuY, 0)
    Children:
      - Main.Content.Container_3:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Fill: =Colors.BackgroundLight
            Height: =Parent.Height - Styles.Header.Height
            Width: =Parent.Width - Styles.Navigation.Width
            X: =Styles.Navigation.Width
            Y: =Styles.Header.Height
          Children:
            - Page.Header.Section_3:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.White
                  Height: =Parent.Height * 0.12
                  Width: =Parent.Width
                Children:
                  - Page.Title_3:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.TextPrimary
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height * 0.5
                        Size: =FontSizes.XLarge
                        Text: ="Quản lý người dùng"
                        Width: =Parent.Width * 0.5
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.25
                  - Add.User.Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.Primary
                        BorderThickness: =If(varLoadingUsers, 2, 1)
                        Color: =Styles.Button.Primary.Color
                        DisplayMode: =If(varLoadingUsers, DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =If(varLoadingUsers, ColorFade(Styles.Button.Primary.Fill, 30%), Styles.Button.Primary.Fill)
                        Height: =Styles.Button.Height
                        HoverFill: =If(varLoadingUsers, Styles.Button.Primary.Fill, Styles.Button.Primary.HoverFill)
                        OnSelect: |
                          =Set(varLoadingUsers, true);
                          Set(varFormMode, "Add");
                          Set(varLoadingUsers, false);
                          Set(varShowUserForm, true)
                        PressedFill: =ColorFade(Styles.Button.Primary.Fill, -10%)
                        Size: =FontSizes.Medium
                        Text: =If(varLoadingUsers, LoadingStates.Button.Text, "+ Thêm người dùng")
                        Width: =Parent.Width * 0.2
                        X: =Parent.Width - Parent.Width * 0.25
                        Y: =Parent.Height * 0.2
            - Users.List.Section:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.BackgroundLight
                  Height: =Parent.Height * 0.88
                  Width: =Parent.Width
                  Y: =86.15999999999997
                Children:
                  - Search.Filter.Bar:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        BorderColor: =Colors.BorderLight
                        BorderThickness: =1
                        Fill: =Colors.White
                        Height: =Parent.Height * 0.08
                        Width: =Parent.Width * 0.94
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.02
                      Children:
                        - Search.Input_1:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =If(Self.Focused, Colors.Primary, If(IsBlank(Self.Text), Colors.Border, Colors.Success))
                              BorderThickness: =If(Self.Focused, InteractionStates.Input.Focus.BorderWidth, InteractionStates.Input.Normal.BorderWidth)
                              Color: =Colors.TextPrimary
                              Default: =""
                              FocusedBorderColor: =Colors.Primary
                              Height: =Styles.Input.Height
                              HintText: ="Tìm kiếm theo tên hoặc email..."
                              OnChange: |
                                =Set(varSearchText, Self.Text)
                              Size: =FontSizes.Base
                              Width: =Parent.Width * 0.35
                              X: =Parent.Width * 0.02
                              Y: =Parent.Height * 0.2
                        - Department.Filter_1:
                            Control: Classic/DropDown@2.3.1
                            Properties:
                              BorderColor: =Colors.Border
                              Default: ="Tất cả"
                              Fill: =Colors.White
                              Height: =Styles.Input.Height
                              Items: |
                                =Concat(
                                  Table({Name: "Tất cả"}),
                                  AddColumns(Department_1, "Name", name),
                                  Value
                                )
                              OnChange: |
                                =Set(varSelectedDepartment, If(Self.Selected.Value = "Tất cả", "", Self.Selected.Value))
                              Width: =Parent.Width * 0.25
                              X: =Parent.Width * 0.4
                              Y: =Parent.Height * 0.2
                        - Role.Filter:
                            Control: Classic/DropDown@2.3.1
                            Properties:
                              BorderColor: =Colors.Border
                              Default: ="Tất cả"
                              Fill: =Colors.White
                              Height: =Styles.Input.Height
                              Items: |
                                =Concat(
                                  Table({Name: "Tất cả"}),
                                  AddColumns(Role_1, "Name", name),
                                  Value
                                )
                              OnChange: |
                                =Set(varSelectedRole, If(Self.Selected.Value = "Tất cả", "", Self.Selected.Value))
                              Width: =Parent.Width * 0.15
                              X: =Parent.Width * 0.68
                              Y: =Parent.Height * 0.2
                        - View.Selected.Button:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =Colors.Success
                              Color: =Colors.Success
                              DisplayMode: =If(IsBlank('Users.DataTable'.Selected), DisplayMode.Disabled, DisplayMode.Edit)
                              Fill: =RGBA(0, 0, 0, 0)
                              Height: =Styles.Input.Height
                              OnSelect: |
                                =If(Not(IsBlank('Users.DataTable'.Selected)),
                                  Set(varSelectedUser, 'Users.DataTable'.Selected);
                                  Set(varShowUserDetail, true);
                                  Set(varDetailFormMode, "View")
                                )
                              Size: =FontSizes.Base
                              Text: "=If(IsBlank('Users.DataTable'.Selected), \"Chọn người dùng\", \"\U0001F441 Xem chi tiết\")"
                              Width: =Parent.Width * 0.15
                              X: =931.634
                              Y: =Parent.Height * 0.2
                  - Users.Data.Table:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        BorderColor: =Colors.BorderLight
                        BorderThickness: =1
                        Fill: =Colors.White
                        Height: =Parent.Height * 0.85
                        Width: =Parent.Width * 0.94
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.12
                      Children:
                        - DataTable.Selection.Handler:
                            Control: Rectangle@2.3.0
                            Properties:
                              Fill: =RGBA(0, 0, 0, 0)
                              Height: =537.064
                              OnSelect: |
                                =If(Not(IsBlank('Users.DataTable'.Selected)),
                                    Set(varSelectedUser, 'Users.DataTable'.Selected);
                                    Set(varContextMenuX, Min(App.ActiveScreen.Width - 150, 150));
                                    Set(varContextMenuY, Min(App.ActiveScreen.Height - 120, 150));
                                 // Set(varContextMenuX, Min(App.ActiveScreen.Width - 150, App.MouseX));
                                 // Set(varContextMenuY, Min(App.ActiveScreen.Height - 120, App.MouseY));
                                    Set(varShowContextMenu, true)
                                )
                              Width: =1096.04
                              X: ='Users.DataTable'.X
                              Y: ='Users.DataTable'.Y
                        - User.Context.Menu:
                            Control: GroupContainer@1.3.0
                            Variant: ManualLayout
                            Properties:
                              BorderColor: =Colors.Border
                              BorderThickness: =1
                              Fill: =Colors.White
                              Height: =120
                              Visible: =varShowContextMenu
                              Width: =150
                              X: =varContextMenuX
                              Y: =varContextMenuY
                            Children:
                              - View.Context.Button:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    Color: =Colors.TextPrimary
                                    Fill: =RGBA(0, 0, 0, 0)
                                    HoverFill: =Colors.BackgroundLight
                                    OnSelect: |
                                      =Set(varShowUserDetail, true);
                                      Set(varDetailFormMode, "View");
                                      Set(varShowContextMenu, false)
                                    Size: =FontSizes.Base
                                    Text: "=\"\U0001F441 Xem chi tiết\""
                                    Width: =Parent.Width
                              - Edit.Context.Button:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    Color: =Colors.TextPrimary
                                    Fill: =RGBA(0, 0, 0, 0)
                                    HoverFill: =Colors.BackgroundLight
                                    OnSelect: |
                                      =Set(varEditingUser, varSelectedUser);
                                      Set(varFormMode, "Edit");
                                      Set(varShowUserForm, true);
                                      Set(varShowContextMenu, false)
                                    Size: =FontSizes.Base
                                    Text: ="✎ Chỉnh sửa"
                                    Width: =Parent.Width
                                    Y: =40
                              - Delete.Context.Button:
                                  Control: Classic/Button@2.2.0
                                  Properties:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    Color: =Colors.Error
                                    Fill: =RGBA(0, 0, 0, 0)
                                    HoverFill: =Colors.BackgroundLight
                                    OnSelect: |
                                      =Set(varDeleteConfirm, true);
                                      Set(varShowContextMenu, false)
                                    Size: =FontSizes.Base
                                    Text: "=\"\U0001F5D1 Xóa\""
                                    Width: =Parent.Width
                                    Y: =80
      - Users.DataTable:
          Control: DataTable@1.0.3
          Properties:
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =Colors.TextPrimary
            Fill: =Colors.White
            Font: =Font.'Segoe UI'
            HeadingColor: =Colors.White
            HeadingFill: =Colors.Primary
            HeadingFont: =Font.'Segoe UI'
            Height: =557
            HoverColor: =Colors.White
            HoverFill: =ColorFade(Colors.Primary, 90%)
            Items: |
              =Filter(colUsers, 
                And(
                  Or(IsBlank(varSearchText), varSearchText in "FullName", varSearchText in "Email"),
                  Or(IsBlank(varSelectedDepartment), Department = varSelectedDepartment),
                  Or(IsBlank(varSelectedRole), Role = varSelectedRole)
                )
              )
            SelectedColor: =Colors.TextPrimary
            SelectedFill: =ColorFade(Colors.Primary, 85%)
            Width: =1130
            X: =235
            Y: =210
          Children:
            - FullName.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Họ và tên"
                  FieldName: ="FullName"
                  Order: =1
                  Text: =ThisItem.fullname
                  Width: =200
            - Email.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Email"
                  FieldName: ="Email"
                  Order: =2
                  Text: =ThisItem.email
                  Width: =250
            - Department.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Phòng ban"
                  FieldName: ="Department"
                  Order: =3
                  Text: =ThisItem.Department
                  Width: =200
            - JobTitle.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Chức vụ"
                  FieldName: ="JobTitle"
                  Order: =4
                  Text: =ThisItem.jobTitle
                  Width: =150
            - Phone.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Điện thoại"
                  FieldName: ="Phone"
                  Order: =5
                  Text: =ThisItem.phone
                  Width: =120
            - Role.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Vai trò"
                  FieldName: ="Role"
                  Order: =6
                  Text: =ThisItem.Role
            - Status.Column:
                Control: DataTableColumn@1.0.1
                Variant: Textual
                Properties:
                  FieldDisplayName: ="Trạng thái"
                  FieldName: ="Status"
                  Order: =7
                  Text: =ThisItem.'Content approval status'
      - User.Form.Modal.Overlay:
          Control: Rectangle@2.3.0
          Properties:
            Fill: =Styles.Modal.Overlay
            Height: =Parent.Height
            OnSelect: |
              =Set(varShowUserForm, false)
            Visible: =varShowUserForm
            Width: =Parent.Width
      - User.Form.Modal:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            BorderColor: =If(varLoadingUsers, Colors.Primary, Colors.Border)
            BorderThickness: =If(varLoadingUsers, 3, 2)
            Fill: =Colors.White
            Height: =Parent.Height * 0.7
            Visible: =varShowUserForm
            Width: =Parent.Width * 0.5
            X: =If(varShowUserForm, (Parent.Width - Parent.Width * 0.5) / 2, -Parent.Width * 2)
            Y: =If(varShowUserForm, (Parent.Height - Parent.Height * 0.7) / 2, -Parent.Height * 2)
          Children:
            - Modal.Header_1:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.Primary
                  Height: =Parent.Height * 0.12
                  Width: =Parent.Width
                Children:
                  - Modal.Title_1:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.White
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height
                        Size: =FontSizes.Large
                        Text: =If(varFormMode = "Add", "Thêm người dùng mới", "Chỉnh sửa thông tin người dùng")
                        Width: =Parent.Width * 0.8
                        X: =Parent.Width * 0.04
                  - Modal.Close.Button_1:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.White
                        Color: =Colors.White
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height * 0.6
                        OnSelect: |
                          =Set(varShowUserForm, false)
                        Size: =FontSizes.Large
                        Text: ="×"
                        Width: =Parent.Height * 0.6
                        X: =Parent.Width * 0.9
                        Y: =Parent.Height * 0.2
            - Form.Content_1:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.White
                  Height: =Parent.Height * 0.76
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.12
                Children:
                  - User.Add.Edit.Form:
                      Control: Form@2.4.4
                      Variant: Classic
                      Layout: Vertical
                      Properties:
                        DataSource: =User_1
                        DefaultMode: =If(varFormMode = "Add", FormMode.New, FormMode.Edit)
                        Fill: =Colors.White
                        Height: =Parent.Height
                        Item: =If(varFormMode = "Edit", varEditingUser, Defaults(User_1))
                        OnFailure: |
                          =Notify("Có lỗi khi lưu dữ liệu: " & FirstError.Message, NotificationType.Error)
                        OnReset: |
                          =Set(varFormMode, "Add"); Set(varEditingUser, Blank())
                        OnSuccess: |
                          =With({
                            newUserID: Concatenate("USER_", Text(Rand() * 1000000, "000000"))
                          },
                            If(varFormMode = "Add",
                              // Create new user
                              Patch(User_1, Defaults(User_1), {
                                userID: newUserID,
                                fullname: 'User.Add.Edit.Form'.fullname_DataCard.Update,
                                email: 'User.Add.Edit.Form'.email_DataCard.Update,
                                departmentID: 'User.Add.Edit.Form'.departmentID_DataCard.Update.departmentID,
                                jobTitle: 'User.Add.Edit.Form'.jobTitle_DataCard.Update,
                                phone: 'User.Add.Edit.Form'.phone_DataCard.Update
                              });
                              // Create user role mapping
                              Patch(User_Role, Defaults(User_Role), {
                                userID: newUserID,
                                roleID: 'User.Add.Edit.Form'.roleID_DataCard.Update.roleID
                              }),
                              // Update existing user
                              Patch(User_1, LookUp(User_1, userID = varEditingUser.userID), {
                                fullname: 'User.Add.Edit.Form'.fullname_DataCard.Update,
                                email: 'User.Add.Edit.Form'.email_DataCard.Update,
                                departmentID: 'User.Add.Edit.Form'.departmentID_DataCard.Update.departmentID,
                                jobTitle: 'User.Add.Edit.Form'.jobTitle_DataCard.Update,
                                phone: 'User.Add.Edit.Form'.phone_DataCard.Update
                              });
                              // Update user role mapping
                              Patch(User_Role, LookUp(User_Role, userID = varEditingUser.userID), {
                                roleID: 'User.Add.Edit.Form'.roleID_DataCard.Update.roleID
                              })
                            )
                          );
                          // Refresh collections
                          ClearCollect(colUsers, 
                            AddColumns(
                              AddColumns(User_1, 
                                "Department", LookUp(Department_1, departmentID = ThisRecord.departmentID).name
                              ),
                              "Role", LookUp(Role_1, roleID = LookUp(User_Role, userID = ThisRecord.userID).roleID).name
                            )
                          );
                          Set(varShowUserForm, false);
                          Notify(If(varFormMode = "Add", "Đã thêm người dùng thành công!", "Đã cập nhật thông tin người dùng!"), NotificationType.Success)
                        Width: =Parent.Width
                      Children:
                        - fullname_DataCard:
                            Control: TypedDataCard@1.0.7
                            Variant: ClassicTextualEdit
                            IsLocked: true
                            Properties:
                              BorderColor: =RGBA(245, 245, 245, 1)
                              DataField: ="fullname"
                              Default: =If(varFormMode = "Edit", varEditingUser.FullName, "")
                              DisplayName: ="Họ và tên"
                              MaxLength: =DataSourceInfo(%DATACARD_DATASOURCE_NAME.ID%, %DataSourceInfo.RESERVED%.MaxLength, '%DATACARD_FIELD_NAME.ID%')
                              Required: =true
                              Update: =DataCardValue1.Text
                              Width: =266
                              X: =0
                              Y: =0
                            Children:
                              - DataCardKey1:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldName
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =34
                                    PaddingLeft: =0
                                    Text: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    Wrap: =false
                                    X: =30
                                    Y: =10
                              - DataCardValue1:
                                  Control: Classic/TextInput@2.3.2
                                  MetadataKey: FieldValue
                                  Properties:
                                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                    Color: =RGBA(50, 49, 48, 1)
                                    Default: =Parent.Default
                                    DelayOutput: =true
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    DisabledFill: =RGBA(242, 242, 241, 0)
                                    DisplayMode: =Parent.DisplayMode
                                    Font: =Font.'Segoe UI'
                                    HintText: ="Nhập họ và tên"
                                    HoverBorderColor: =RGBA(16, 110, 190, 1)
                                    HoverColor: =RGBA(50, 49, 48, 1)
                                    HoverFill: =RGBA(255, 255, 255, 1)
                                    PaddingLeft: =5
                                    PressedBorderColor: =RGBA(0, 120, 212, 1)
                                    PressedColor: =RGBA(50, 49, 48, 1)
                                    PressedFill: =RGBA(255, 255, 255, 1)
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Tooltip: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardKey1.Y + DataCardKey1.Height + 5
                              - ErrorMessage1:
                                  Control: Label@2.5.1
                                  MetadataKey: ErrorMessage
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(168, 0, 0, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(168, 0, 0, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =10
                                    Live: =Live.Assertive
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Text: =Parent.Error
                                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardValue1.Y + DataCardValue1.Height
                              - StarVisible1:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldRequired
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =DataCardKey1.Height
                                    PaddingLeft: =0
                                    Text: ="*"
                                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                    Width: =30
                                    Wrap: =false
                                    Y: =DataCardKey1.Y
                        - email_DataCard:
                            Control: TypedDataCard@1.0.7
                            Variant: ClassicTextualEdit
                            IsLocked: true
                            Properties:
                              BorderColor: =RGBA(245, 245, 245, 1)
                              DataField: ="email"
                              Default: =If(varFormMode = "Edit", varEditingUser.Email, "")
                              DisplayName: ="Email"
                              MaxLength: =DataSourceInfo(%DATACARD_DATASOURCE_NAME.ID%, %DataSourceInfo.RESERVED%.MaxLength, '%DATACARD_FIELD_NAME.ID%')
                              Required: =true
                              Update: =DataCardValue2.Text
                              Width: =266
                              X: =280
                              Y: =0
                            Children:
                              - DataCardKey2:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldName
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =34
                                    PaddingLeft: =0
                                    Text: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    Wrap: =false
                                    X: =30
                                    Y: =10
                              - DataCardValue2:
                                  Control: Classic/TextInput@2.3.2
                                  MetadataKey: FieldValue
                                  Properties:
                                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                    Color: =RGBA(50, 49, 48, 1)
                                    Default: =Parent.Default
                                    DelayOutput: =true
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    DisabledFill: =RGBA(242, 242, 241, 0)
                                    DisplayMode: =Parent.DisplayMode
                                    Font: =Font.'Segoe UI'
                                    Format: =TextFormat.Email
                                    HintText: ="Nhập email"
                                    HoverBorderColor: =RGBA(16, 110, 190, 1)
                                    HoverColor: =RGBA(50, 49, 48, 1)
                                    HoverFill: =RGBA(255, 255, 255, 1)
                                    PaddingLeft: =5
                                    PressedBorderColor: =RGBA(0, 120, 212, 1)
                                    PressedColor: =RGBA(50, 49, 48, 1)
                                    PressedFill: =RGBA(255, 255, 255, 1)
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Tooltip: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardKey2.Y + DataCardKey2.Height + 5
                              - ErrorMessage2:
                                  Control: Label@2.5.1
                                  MetadataKey: ErrorMessage
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(168, 0, 0, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(168, 0, 0, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =10
                                    Live: =Live.Assertive
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Text: =Parent.Error
                                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardValue2.Y + DataCardValue2.Height
                              - StarVisible2:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldRequired
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =DataCardKey2.Height
                                    PaddingLeft: =0
                                    Text: ="*"
                                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                    Width: =30
                                    Wrap: =false
                                    Y: =DataCardKey2.Y
                        - departmentID_DataCard:
                            Control: TypedDataCard@1.0.7
                            Variant: ClassicComboBoxEdit
                            IsLocked: true
                            Properties:
                              BorderColor: =RGBA(245, 245, 245, 1)
                              DataField: ="departmentID"
                              Default: =If(varFormMode = "Edit", LookUp(Department_1, name = varEditingUser.Department), LookUp(Department_1, name = "Phòng Công nghệ thông tin"))
                              DisplayName: ="Phòng ban"
                              Required: =true
                              Update: =DataCardValue3.Selected
                              Width: =266
                              X: =0
                              Y: =100
                            Children:
                              - DataCardKey3:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldName
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =34
                                    PaddingLeft: =0
                                    Text: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    Wrap: =false
                                    X: =30
                                    Y: =10
                              - DataCardValue3:
                                  Control: Classic/ComboBox@2.4.0
                                  MetadataKey: FieldValue
                                  Properties:
                                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                    ChevronBackground: =RGBA(245, 245, 245, 1)
                                    ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                                    ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                                    ChevronFill: =RGBA(50, 49, 48, 1)
                                    ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                                    ChevronHoverFill: =RGBA(50, 49, 48, 1)
                                    Color: =RGBA(50, 49, 48, 1)
                                    DefaultSelectedItems: =Parent.Default
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    DisabledFill: =RGBA(242, 242, 241, 0)
                                    DisplayFields: =["name"]
                                    DisplayMode: =Parent.DisplayMode
                                    Fill: =RGBA(245, 245, 245, 1)
                                    Font: =Font.'Segoe UI'
                                    HoverBorderColor: =RGBA(16, 110, 190, 1)
                                    HoverColor: =RGBA(50, 49, 48, 1)
                                    HoverFill: =RGBA(245, 245, 245, 1)
                                    Items: =Department_1
                                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                    PressedBorderColor: =RGBA(16, 110, 190, 1)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 120, 212, 1)
                                    SearchFields: =["name"]
                                    SelectMultiple: =false
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(0, 120, 212, 1)
                                    Tooltip: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardKey3.Y + DataCardKey3.Height + 5
                              - ErrorMessage3:
                                  Control: Label@2.5.1
                                  MetadataKey: ErrorMessage
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(168, 0, 0, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(168, 0, 0, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =10
                                    Live: =Live.Assertive
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Text: =Parent.Error
                                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardValue3.Y + DataCardValue3.Height
                              - StarVisible3:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldRequired
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =DataCardKey3.Height
                                    PaddingLeft: =0
                                    Text: ="*"
                                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                    Width: =30
                                    Wrap: =false
                                    Y: =DataCardKey3.Y
                        - jobTitle_DataCard:
                            Control: TypedDataCard@1.0.7
                            Variant: ClassicTextualEdit
                            IsLocked: true
                            Properties:
                              BorderColor: =RGBA(245, 245, 245, 1)
                              DataField: ="jobTitle"
                              Default: =If(varFormMode = "Edit", varEditingUser.JobTitle, "")
                              DisplayName: ="Chức vụ"
                              MaxLength: =DataSourceInfo(%DATACARD_DATASOURCE_NAME.ID%, %DataSourceInfo.RESERVED%.MaxLength, '%DATACARD_FIELD_NAME.ID%')
                              Required: =true
                              Update: =DataCardValue4.Text
                              Width: =266
                              X: =280
                              Y: =100
                            Children:
                              - DataCardKey4:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldName
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =34
                                    PaddingLeft: =0
                                    Text: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    Wrap: =false
                                    X: =30
                                    Y: =10
                              - DataCardValue4:
                                  Control: Classic/TextInput@2.3.2
                                  MetadataKey: FieldValue
                                  Properties:
                                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                    Color: =RGBA(50, 49, 48, 1)
                                    Default: =Parent.Default
                                    DelayOutput: =true
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    DisabledFill: =RGBA(242, 242, 241, 0)
                                    DisplayMode: =Parent.DisplayMode
                                    Font: =Font.'Segoe UI'
                                    HintText: ="Nhập chức vụ"
                                    HoverBorderColor: =RGBA(16, 110, 190, 1)
                                    HoverColor: =RGBA(50, 49, 48, 1)
                                    HoverFill: =RGBA(255, 255, 255, 1)
                                    PaddingLeft: =5
                                    PressedBorderColor: =RGBA(0, 120, 212, 1)
                                    PressedColor: =RGBA(50, 49, 48, 1)
                                    PressedFill: =RGBA(255, 255, 255, 1)
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Tooltip: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardKey4.Y + DataCardKey4.Height + 5
                              - ErrorMessage4:
                                  Control: Label@2.5.1
                                  MetadataKey: ErrorMessage
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(168, 0, 0, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(168, 0, 0, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =10
                                    Live: =Live.Assertive
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Text: =Parent.Error
                                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardValue4.Y + DataCardValue4.Height
                              - StarVisible4:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldRequired
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =DataCardKey4.Height
                                    PaddingLeft: =0
                                    Text: ="*"
                                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                    Width: =30
                                    Wrap: =false
                                    Y: =DataCardKey4.Y
                        - phone_DataCard:
                            Control: TypedDataCard@1.0.7
                            Variant: ClassicTextualEdit
                            IsLocked: true
                            Properties:
                              BorderColor: =RGBA(245, 245, 245, 1)
                              DataField: ="phone"
                              Default: =If(varFormMode = "Edit", varEditingUser.Phone, "")
                              DisplayName: ="Số điện thoại"
                              MaxLength: =DataSourceInfo(%DATACARD_DATASOURCE_NAME.ID%, %DataSourceInfo.RESERVED%.MaxLength, '%DATACARD_FIELD_NAME.ID%')
                              Required: =true
                              Update: =DataCardValue5.Text
                              Width: =266
                              X: =0
                              Y: =200
                            Children:
                              - DataCardKey5:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldName
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =34
                                    PaddingLeft: =0
                                    Text: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    Wrap: =false
                                    X: =30
                                    Y: =10
                              - DataCardValue5:
                                  Control: Classic/TextInput@2.3.2
                                  MetadataKey: FieldValue
                                  Properties:
                                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                    Color: =RGBA(50, 49, 48, 1)
                                    Default: =Parent.Default
                                    DelayOutput: =true
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    DisabledFill: =RGBA(242, 242, 241, 0)
                                    DisplayMode: =Parent.DisplayMode
                                    Font: =Font.'Segoe UI'
                                    Format: =TextFormat.Number
                                    HintText: ="Nhập số điện thoại"
                                    HoverBorderColor: =RGBA(16, 110, 190, 1)
                                    HoverColor: =RGBA(50, 49, 48, 1)
                                    HoverFill: =RGBA(255, 255, 255, 1)
                                    PaddingLeft: =5
                                    PressedBorderColor: =RGBA(0, 120, 212, 1)
                                    PressedColor: =RGBA(50, 49, 48, 1)
                                    PressedFill: =RGBA(255, 255, 255, 1)
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Tooltip: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardKey5.Y + DataCardKey5.Height + 5
                              - ErrorMessage5:
                                  Control: Label@2.5.1
                                  MetadataKey: ErrorMessage
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(168, 0, 0, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(168, 0, 0, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =10
                                    Live: =Live.Assertive
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Text: =Parent.Error
                                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardValue5.Y + DataCardValue5.Height
                              - StarVisible5:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldRequired
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =DataCardKey5.Height
                                    PaddingLeft: =0
                                    Text: ="*"
                                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                    Width: =30
                                    Wrap: =false
                                    Y: =DataCardKey5.Y
                        - roleID_DataCard:
                            Control: TypedDataCard@1.0.7
                            Variant: ClassicComboBoxEdit
                            IsLocked: true
                            Properties:
                              BorderColor: =RGBA(245, 245, 245, 1)
                              DataField: ="roleID"
                              Default: =If(varFormMode = "Edit", LookUp(Role_1, name = varEditingUser.Role), LookUp(Role_1, name = "Employee"))
                              DisplayName: ="Vai trò"
                              Required: =true
                              Update: =DataCardValue6.Selected
                              Width: =266
                              X: =280
                              Y: =200
                            Children:
                              - DataCardKey6:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldName
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =34
                                    PaddingLeft: =0
                                    Text: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    Wrap: =false
                                    X: =30
                                    Y: =10
                              - DataCardValue6:
                                  Control: Classic/ComboBox@2.4.0
                                  MetadataKey: FieldValue
                                  Properties:
                                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                    ChevronBackground: =RGBA(245, 245, 245, 1)
                                    ChevronDisabledBackground: =RGBA(242, 242, 241, 0)
                                    ChevronDisabledFill: =RGBA(161, 159, 157, 1)
                                    ChevronFill: =RGBA(50, 49, 48, 1)
                                    ChevronHoverBackground: =RGBA(245, 245, 245, 1)
                                    ChevronHoverFill: =RGBA(50, 49, 48, 1)
                                    Color: =RGBA(50, 49, 48, 1)
                                    DefaultSelectedItems: =Parent.Default
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    DisabledFill: =RGBA(242, 242, 241, 0)
                                    DisplayFields: =["name"]
                                    DisplayMode: =Parent.DisplayMode
                                    Fill: =RGBA(245, 245, 245, 1)
                                    Font: =Font.'Segoe UI'
                                    HoverBorderColor: =RGBA(16, 110, 190, 1)
                                    HoverColor: =RGBA(50, 49, 48, 1)
                                    HoverFill: =RGBA(245, 245, 245, 1)
                                    Items: =Role_1
                                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                    PressedBorderColor: =RGBA(16, 110, 190, 1)
                                    PressedColor: =RGBA(255, 255, 255, 1)
                                    PressedFill: =RGBA(0, 120, 212, 1)
                                    SearchFields: =["name"]
                                    SelectMultiple: =false
                                    SelectionColor: =RGBA(255, 255, 255, 1)
                                    SelectionFill: =RGBA(0, 120, 212, 1)
                                    Tooltip: =Parent.DisplayName
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardKey6.Y + DataCardKey6.Height + 5
                              - ErrorMessage6:
                                  Control: Label@2.5.1
                                  MetadataKey: ErrorMessage
                                  Properties:
                                    AutoHeight: =true
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(168, 0, 0, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(168, 0, 0, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =10
                                    Live: =Live.Assertive
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Text: =Parent.Error
                                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                                    Width: =Parent.Width - 60
                                    X: =30
                                    Y: =DataCardValue6.Y + DataCardValue6.Height
                              - StarVisible6:
                                  Control: Label@2.5.1
                                  MetadataKey: FieldRequired
                                  Properties:
                                    Align: =Align.Center
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =RGBA(50, 49, 48, 1)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    DisabledColor: =RGBA(161, 159, 157, 1)
                                    FocusedBorderThickness: =4
                                    Font: =Font.'Segoe UI'
                                    FontWeight: =FontWeight.Semibold
                                    Height: =DataCardKey6.Height
                                    PaddingLeft: =0
                                    Text: ="*"
                                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                                    Width: =30
                                    Wrap: =false
                                    Y: =DataCardKey6.Y
            - Form.Footer_1:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Colors.BorderLight
                  BorderThickness: =1
                  Fill: =Colors.BackgroundLight
                  Height: =Parent.Height * 0.12
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.88
                Children:
                  - Cancel.Button_1:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.Border
                        Color: =Styles.Button.Secondary.Color
                        Fill: =Styles.Button.Secondary.Fill
                        Height: =Styles.Button.Height
                        HoverFill: =Styles.Button.Secondary.HoverFill
                        OnSelect: |
                          =ResetForm('User.Add.Edit.Form');
                          Set(varShowUserForm, false)
                        Size: =FontSizes.Medium
                        Text: ="Hủy"
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width * 0.55
                        Y: =Parent.Height * 0.2
                  - Save.Button_1:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.Primary
                        Color: =Styles.Button.Primary.Color
                        DisplayMode: =If('User.Add.Edit.Form'.Valid, DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =Styles.Button.Primary.Fill
                        Height: =Styles.Button.Height
                        HoverFill: =Styles.Button.Primary.HoverFill
                        OnSelect: |
                          =SubmitForm('User.Add.Edit.Form')
                        Size: =FontSizes.Medium
                        Text: =If(varFormMode = "Add", "Thêm người dùng", "Cập nhật")
                        Width: =Parent.Width * 0.2
                        X: =Parent.Width * 0.75
                        Y: =Parent.Height * 0.2
      - Delete.Modal.Overlay:
          Control: Rectangle@2.3.0
          Properties:
            Fill: =Styles.Modal.Overlay
            Height: =Parent.Height
            OnSelect: |
              =Set(varDeleteConfirm, false)
            Visible: =varDeleteConfirm
            Width: =Parent.Width
      - Delete.Confirmation.Modal:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Fill: =Colors.White
            Height: =Parent.Height * 0.3
            Visible: =varDeleteConfirm
            Width: =Parent.Width * 0.4
            X: =If(varDeleteConfirm, (Parent.Width - Parent.Width * 0.4) / 2, -Parent.Width)
            Y: =If(varDeleteConfirm, (Parent.Height - Parent.Height * 0.3) / 2, -Parent.Height)
          Children:
            - Confirm.Header:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.Error
                  Height: =Parent.Height * 0.25
                  Width: =Parent.Width
                Children:
                  - Confirm.Title:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        Color: =Colors.White
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height
                        Size: =FontSizes.Large
                        Text: ="Xác nhận xóa người dùng"
                        Width: =Parent.Width
            - Confirm.Content:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.White
                  Height: =Parent.Height * 0.5
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.25
                Children:
                  - Confirm.Message:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        Color: =Colors.TextPrimary
                        Height: =Parent.Height
                        Size: =FontSizes.Base
                        Text: =Concatenate("Bạn có chắc chắn muốn xóa người dùng ", varSelectedUser.FullName, "?")
                        Width: =Parent.Width * 0.9
                        X: =Parent.Width * 0.05
            - Confirm.Footer:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.BackgroundLight
                  Height: =Parent.Height * 0.25
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.75
                Children:
                  - Confirm.Cancel.Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.Border
                        Color: =Styles.Button.Secondary.Color
                        Fill: =Styles.Button.Secondary.Fill
                        Height: =Styles.Button.Height
                        HoverFill: =Styles.Button.Secondary.HoverFill
                        OnSelect: |
                          =Set(varDeleteConfirm, false)
                        Size: =FontSizes.Medium
                        Text: ="Hủy"
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width * 0.3
                        Y: =Parent.Height * 0.2
                  - Confirm.Delete.Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.Error
                        Color: =Styles.Button.Danger.Color
                        Fill: =Styles.Button.Danger.Fill
                        Height: =Styles.Button.Height
                        HoverFill: =Styles.Button.Danger.HoverFill
                        OnSelect: |
                          =RemoveIf(colUsers, Id = varSelectedUser.Id);
                          Set(varDeleteConfirm, false);
                          Notify("Đã xóa người dùng thành công!", NotificationType.Success)
                        Size: =FontSizes.Medium
                        Text: ="Xóa"
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width * 0.55
                        Y: =Parent.Height * 0.2
      - User.Detail.Modal.Overlay:
          Control: Rectangle@2.3.0
          Properties:
            Fill: =Styles.Modal.Overlay
            Height: =Parent.Height
            OnSelect: |
              =Set(varShowUserDetail, false)
            Visible: =varShowUserDetail
            Width: =Parent.Width
      - User.Detail.Modal:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            BorderColor: =Colors.Border
            BorderThickness: =2
            Fill: =Colors.White
            Height: =Parent.Height * 0.7
            Visible: =varShowUserDetail
            Width: =Parent.Width * 0.5
            X: =If(varShowUserDetail, (Parent.Width - Parent.Width * 0.5) / 2, -Parent.Width * 2)
            Y: =If(varShowUserDetail, (Parent.Height - Parent.Height * 0.7) / 2, -Parent.Height * 2)
          Children:
            - Detail.Modal.Header:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.Primary
                  Height: =Parent.Height * 0.12
                  Width: =Parent.Width
                Children:
                  - Detail.Modal.Title:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.White
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height
                        Size: =FontSizes.Large
                        Text: ="Thông tin người dùng"
                        Width: =Parent.Width * 0.6
                        X: =Parent.Width * 0.04
                  - Edit.Toggle.Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.White
                        Color: =Colors.White
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height * 0.6
                        OnSelect: |
                          =If(varDetailFormMode = "View",
                            Set(varDetailFormMode, "Edit");
                            Set(varErrorMessage, ""),
                            Set(varDetailFormMode, "View");
                            Set(varErrorMessage, "")
                          )
                        Size: =FontSizes.Medium
                        Text: =If(varDetailFormMode = "View", "Chỉnh sửa ✎", "Huỷ chỉnh sửa ✕")
                        Width: =Parent.Width * 0.25
                        X: =Parent.Width * 0.6
                        Y: =Parent.Height * 0.2
                  - Detail.Modal.Close.Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.White
                        Color: =Colors.White
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height * 0.6
                        OnSelect: |
                          =Set(varShowUserDetail, false);
                          Set(varDetailFormMode, "View")
                        Size: =FontSizes.Large
                        Text: ="×"
                        Width: =Parent.Height * 0.6
                        X: =Parent.Width * 0.9
                        Y: =Parent.Height * 0.2
            - Detail.Form.Content:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.White
                  Height: =Parent.Height * 0.76
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.12
                Children:
                  - Detail.Form.Fields.Container:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =Colors.White
                        Height: =Parent.Height
                        Width: =Parent.Width
                      Children:
                        - Detail.FullName.Label:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =25
                              Size: =FontSizes.Base
                              Text: ="Họ và tên *"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.05
                              Y: =20
                        - Detail.FullName.Display:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =Colors.Border
                              BorderThickness: =If(varDetailFormMode = "View", 1, 0)
                              Color: =Colors.TextPrimary
                              Fill: =If(varDetailFormMode = "View", Colors.BackgroundLight, Colors.White)
                              Height: =Styles.Input.Height
                              Size: =FontSizes.Base
                              Text: =varSelectedUser.FullName
                              Visible: =varDetailFormMode = "View"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.05
                              Y: =45
                        - Detail.FullName.Input:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =If(Self.Focused, Colors.Primary, Colors.Border)
                              Default: =varSelectedUser.FullName
                              Height: =Styles.Input.Height
                              Size: =FontSizes.Base
                              Visible: =varDetailFormMode = "Edit"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.05
                              Y: =45
                        - Detail.Email.Label:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =25
                              Size: =FontSizes.Base
                              Text: ="Email *"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.55
                              Y: =20
                        - Detail.Email.Display:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =Colors.Border
                              BorderThickness: =If(varDetailFormMode = "View", 1, 0)
                              Color: =Colors.TextPrimary
                              Fill: =If(varDetailFormMode = "View", Colors.BackgroundLight, Colors.White)
                              Height: =Styles.Input.Height
                              Size: =FontSizes.Base
                              Text: =varSelectedUser.Email
                              Visible: =varDetailFormMode = "View"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.55
                              Y: =45
                        - Detail.Email.Input:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =If(Self.Focused, Colors.Primary, Colors.Border)
                              Default: =varSelectedUser.Email
                              Height: =Styles.Input.Height
                              Size: =FontSizes.Base
                              Visible: =varDetailFormMode = "Edit"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.55
                              Y: =45
                        - Detail.Department.Label:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =25
                              Size: =FontSizes.Base
                              Text: ="Phòng ban *"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.05
                              Y: =95
                        - Detail.Department.Display:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =Colors.Border
                              BorderThickness: =If(varDetailFormMode = "View", 1, 0)
                              Color: =Colors.TextPrimary
                              Fill: =If(varDetailFormMode = "View", Colors.BackgroundLight, Colors.White)
                              Height: =Styles.Input.Height
                              Size: =FontSizes.Base
                              Text: =varSelectedUser.Department
                              Visible: =varDetailFormMode = "View"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.05
                              Y: =120
                        - Detail.Department.Dropdown:
                            Control: Classic/DropDown@2.3.1
                            Properties:
                              BorderColor: =If(Self.Focus, Colors.Primary, Colors.Border)
                              Default: =varSelectedUser.Department
                              Height: =Styles.Input.Height
                              Items: =Department_1.name
                              Items.Value: =name
                              Size: =FontSizes.Base
                              Visible: =varDetailFormMode = "Edit"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.05
                              Y: =120
                        - Detail.JobTitle.Label:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =25
                              Size: =FontSizes.Base
                              Text: ="Chức vụ *"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.55
                              Y: =95
                        - Detail.JobTitle.Display:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =Colors.Border
                              BorderThickness: =If(varDetailFormMode = "View", 1, 0)
                              Color: =Colors.TextPrimary
                              Fill: =If(varDetailFormMode = "View", Colors.BackgroundLight, Colors.White)
                              Height: =Styles.Input.Height
                              Size: =FontSizes.Base
                              Text: =varSelectedUser.JobTitle
                              Visible: =varDetailFormMode = "View"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.55
                              Y: =120
                        - Detail.JobTitle.Input:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =If(Self.Focused, Colors.Primary, Colors.Border)
                              Default: =varSelectedUser.JobTitle
                              Height: =Styles.Input.Height
                              Size: =FontSizes.Base
                              Visible: =varDetailFormMode = "Edit"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.55
                              Y: =120
                        - Detail.Phone.Label:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =25
                              Size: =FontSizes.Base
                              Text: ="Số điện thoại *"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.05
                              Y: =170
                        - Detail.Phone.Display:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =Colors.Border
                              BorderThickness: =If(varDetailFormMode = "View", 1, 0)
                              Color: =Colors.TextPrimary
                              Fill: =If(varDetailFormMode = "View", Colors.BackgroundLight, Colors.White)
                              Height: =Styles.Input.Height
                              Size: =FontSizes.Base
                              Text: =varSelectedUser.Phone
                              Visible: =varDetailFormMode = "View"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.05
                              Y: =195
                        - Detail.Phone.Input:
                            Control: Classic/TextInput@2.3.2
                            Properties:
                              BorderColor: =If(Self.Focused, Colors.Primary, Colors.Border)
                              Default: =varSelectedUser.Phone
                              Height: =Styles.Input.Height
                              Size: =FontSizes.Base
                              Visible: =varDetailFormMode = "Edit"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.05
                              Y: =195
                        - Detail.Role.Label:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =25
                              Size: =FontSizes.Base
                              Text: ="Vai trò *"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.55
                              Y: =170
                        - Detail.Role.Display:
                            Control: Label@2.5.1
                            Properties:
                              BorderColor: =Colors.Border
                              BorderThickness: =If(varDetailFormMode = "View", 1, 0)
                              Color: =Colors.TextPrimary
                              Fill: =If(varDetailFormMode = "View", Colors.BackgroundLight, Colors.White)
                              Height: =Styles.Input.Height
                              Size: =FontSizes.Base
                              Text: =varSelectedUser.Role
                              Visible: =varDetailFormMode = "View"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.55
                              Y: =195
                        - Detail.Role.Dropdown:
                            Control: Classic/DropDown@2.3.1
                            Properties:
                              BorderColor: =If(Self.Focus, Colors.Primary, Colors.Border)
                              Default: =varSelectedUser.Role
                              Height: =Styles.Input.Height
                              Items: =Role_1.name
                              Items.Value: =name
                              Size: =FontSizes.Base
                              Visible: =varDetailFormMode = "Edit"
                              Width: =Parent.Width * 0.4
                              X: =Parent.Width * 0.55
                              Y: =195
                        - Detail.Error.Message:
                            Control: Label@2.5.1
                            Properties:
                              AutoHeight: =true
                              Color: =Colors.Error
                              FontWeight: =FontWeight.Semibold
                              Height: =30
                              Size: =FontSizes.Base
                              Text: =varErrorMessage
                              Visible: =Not(IsBlank(varErrorMessage)) && varDetailFormMode = "Edit"
                              Width: =Parent.Width * 0.9
                              X: =Parent.Width * 0.05
                              Y: =240
            - Detail.Form.Footer:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Colors.BorderLight
                  BorderThickness: =1
                  Fill: =Colors.BackgroundLight
                  Height: =Parent.Height * 0.12
                  Visible: =varDetailFormMode = "Edit"
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.88
                Children:
                  - Detail.Cancel.Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.Border
                        Color: =Styles.Button.Secondary.Color
                        Fill: =Styles.Button.Secondary.Fill
                        Height: =Styles.Button.Height
                        HoverFill: =Styles.Button.Secondary.HoverFill
                        OnSelect: |
                          =Set(varDetailFormMode, "View");
                          Set(varErrorMessage, "")
                        Size: =FontSizes.Medium
                        Text: ="Huỷ"
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width * 0.55
                        Y: =Parent.Height * 0.2
                  - Detail.Save.Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =Colors.Primary
                        Color: =Styles.Button.Primary.Color
                        Fill: =Styles.Button.Primary.Fill
                        Height: =Styles.Button.Height
                        HoverFill: =Styles.Button.Primary.HoverFill
                        OnSelect: |
                          =// Clear previous errors
                          Set(varErrorMessage, "");
                          // Update SharePoint data with error handling
                          IfError(
                            // Update user information
                            Patch(User_1, LookUp(User_1, userID = varSelectedUser.userID), {
                              fullname: 'Detail.FullName.Input'.Text,
                              email: 'Detail.Email.Input'.Text,
                              departmentID: LookUp(Department_1, name = 'Detail.Department.Dropdown'.Selected.Value).departmentID,
                              jobTitle: 'Detail.JobTitle.Input'.Text,
                              phone: 'Detail.Phone.Input'.Text
                            });
                            // Update user role mapping
                            Patch(User_Role, LookUp(User_Role, userID = varSelectedUser.userID), {
                              roleID: LookUp(Role_1, name = 'Detail.Role.Dropdown'.Selected.Value).roleID
                            });
                            // Refresh collections to reflect changes
                            ClearCollect(colUsers, 
                              AddColumns(
                                AddColumns(User_1, 
                                  "Department", LookUp(Department_1, departmentID = ThisRecord.departmentID).name
                                ),
                                "Role", LookUp(Role_1, roleID = LookUp(User_Role, userID = ThisRecord.userID).roleID).name
                              )
                            );
                            // Update selected user with new data
                            Set(varSelectedUser, LookUp(colUsers, userID = varSelectedUser.userID));
                            // Switch back to view mode
                            Set(varDetailFormMode, "View");
                            // Show success notification
                            Notify("Đã cập nhật thông tin người dùng thành công!", NotificationType.Success),
                            // Error handling
                            Set(varErrorMessage, "Có lỗi khi cập nhật thông tin: " & FirstError.Message)
                          )
                        Size: =FontSizes.Medium
                        Text: ="Lưu"
                        Width: =Parent.Width * 0.2
                        X: =Parent.Width * 0.75
                        Y: =Parent.Height * 0.2
      - Loading.Overlay_1:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 0.8)
            Height: =Parent.Height
            Visible: =varLoadingUsers
            Width: =Parent.Width
          Children:
            - Loading.Spinner_1:
                Control: Classic/Icon@2.5.0
                Properties:
                  Color: =Colors.Primary
                  Height: =40
                  Icon: =Icon.Sync
                  Visible: =varLoadingUsers
                  Width: =40
                  X: =(Parent.Width - 40) / 2
                  Y: =(Parent.Height - 40) / 2
