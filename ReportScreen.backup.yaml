Screens:
  ReportScreen:
    Properties:
      Fill: =Colors.BackgroundLight
      OnVisible: |
        =ClearCollect(colReportData,
          {Id: 1, RequestCode: "YC-001", EmployeeName: "Nguyễn Văn An", Department: "Phòng Công nghệ thông tin", 
           CardType: "Standard", Priority: "Normal", RequestDate: Date(2024, 1, 15), 
           ApprovalDate: Date(2024, 1, 18), Status: "Approved", PrintStatus: "Printed", 
           DistributionDate: Date(2024, 1, 20), ProcessingDays: 5, Cost: 50000},
          {Id: 2, RequestCode: "YC-002", EmployeeName: "Nguyễn Văn An", Department: "Phòng Công nghệ thông tin", 
           CardType: "Executive", Priority: "High", RequestDate: Date(2024, 1, 10), 
           ApprovalDate: Blank(), Status: "PendingManagerApproval", PrintStatus: "NotPrinted", 
           DistributionDate: Blank(), ProcessingDays: Blank(), Cost: 80000},
          {Id: 3, RequestCode: "YC-003", EmployeeName: "Nguyễn Văn An", Department: "Phòng Công nghệ thông tin", 
           CardType: "Temporary", Priority: "Low", RequestDate: Date(2024, 1, 5), 
           ApprovalDate: Date(2024, 1, 8), Status: "Rejected", PrintStatus: "NotPrinted", 
           DistributionDate: Blank(), ProcessingDays: 3, Cost: 0},
          {Id: 4, RequestCode: "YC-004", EmployeeName: "Phạm Thị Dung", Department: "Phòng Marketing", 
           CardType: "Standard", Priority: "Normal", RequestDate: Date(2024, 1, 20), 
           ApprovalDate: Date(2024, 1, 22), Status: "PendingHRApproval", PrintStatus: "NotPrinted", 
           DistributionDate: Blank(), ProcessingDays: Blank(), Cost: 50000},
          {Id: 5, RequestCode: "YC-005", EmployeeName: "Lê Văn Cường", Department: "Phòng Kế toán", 
           CardType: "Standard", Priority: "Normal", RequestDate: Date(2024, 1, 25), 
           ApprovalDate: Date(2024, 1, 27), Status: "Approved", PrintStatus: "Printed", 
           DistributionDate: Date(2024, 1, 30), ProcessingDays: 5, Cost: 50000},
          {Id: 6, RequestCode: "YC-006", EmployeeName: "Trần Thị Bình", Department: "Phòng Nhân sự", 
           CardType: "Executive", Priority: "High", RequestDate: Date(2024, 2, 1), 
           ApprovalDate: Date(2024, 2, 2), Status: "Approved", PrintStatus: "Printing", 
           DistributionDate: Blank(), ProcessingDays: Blank(), Cost: 80000}
        );
        Set(varCurrentUser, {FullName: "Trần Thị Bình", Role: "Manager", Department: "Phòng Công nghệ thông tin"});
        Set(varReportViewType, "Table");
        Set(varFilterMonth, Text(Today(), "mm"));
        Set(varFilterYear, Text(Today(), "yyyy"));
        Set(varFilterDepartment, "All");
        Set(varFilterStatus, "All");
        Set(varFilterPriority, "All");
        Set(varDateFrom, DateAdd(Today(), -30, Days));
        Set(varDateTo, Today());
        UpdateContext({
          reportStats: {
            TotalRequests: CountRows(colReportData),
            ApprovedRequests: CountRows(Filter(colReportData, Status = "Approved")),
            PendingRequests: CountRows(Filter(colReportData, Status in ["PendingManagerApproval", "PendingHRApproval"])),
            RejectedRequests: CountRows(Filter(colReportData, Status = "Rejected")),
            TotalCost: Sum(colReportData, Cost),
            AverageProcessingDays: Average(Filter(colReportData, Not(IsBlank(ProcessingDays))), ProcessingDays)
          }
        });
        Set(varFilteredData, colReportData)
    Children:
      - Main.Content.Container_2:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Fill: =Colors.BackgroundLight
            Height: =Parent.Height - Styles.Header.Height
            Width: =Parent.Width - Styles.Navigation.Width
            X: =Styles.Navigation.Width
            Y: =Styles.Header.Height
          Children:
            - Report.Content.Section:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.BackgroundLight
                  Height: =Parent.Height * 0.55
                  Width: =Parent.Width
                  Y: =323.09999999999997
                Children:
                  - Table.View.Container:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =Colors.White
                        Height: =Parent.Height * 0.96
                        Visible: =varReportViewType = "Table"
                        Width: =Parent.Width * 0.96
                        X: =Parent.Width * 0.02
                        Y: =Parent.Height * 0.02
                      Children:
                        - Report.Table.Header:
                            Control: GroupContainer@1.3.0
                            Variant: ManualLayout
                            Properties:
                              Fill: =Colors.BackgroundLight
                              Height: =Parent.Height * 0.08
                              Width: =Parent.Width
                            Children:
                              - Header.RequestCode_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height
                                    Size: =FontSizes.Small
                                    Text: ="Mã YC"
                                    Width: =Parent.Width * 0.1
                                    X: =Parent.Width * 0.02
                              - Header.Employee_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height
                                    Size: =FontSizes.Small
                                    Text: ="Nhân viên"
                                    Width: =Parent.Width * 0.15
                                    X: =Parent.Width * 0.12
                              - Header.Department:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height
                                    Size: =FontSizes.Small
                                    Text: ="Phòng ban"
                                    Width: =Parent.Width * 0.18
                                    X: =Parent.Width * 0.27
                              - Header.CardType_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height
                                    Size: =FontSizes.Small
                                    Text: ="Loại thẻ"
                                    Width: =Parent.Width * 0.1
                                    X: =Parent.Width * 0.45
                              - Header.RequestDate_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height
                                    Size: =FontSizes.Small
                                    Text: ="Ngày tạo"
                                    Width: =Parent.Width * 0.1
                                    X: =Parent.Width * 0.55
                              - Header.Status_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height
                                    Size: =FontSizes.Small
                                    Text: ="Trạng thái"
                                    Width: =Parent.Width * 0.12
                                    X: =Parent.Width * 0.65
                              - Header.Priority_1:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height
                                    Size: =FontSizes.Small
                                    Text: ="Ưu tiên"
                                    Width: =Parent.Width * 0.08
                                    X: =Parent.Width * 0.77
                              - Header.Cost:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    FontWeight: =FontWeight.Semibold
                                    Height: =Parent.Height
                                    Size: =FontSizes.Small
                                    Text: ="Chi phí (VND)"
                                    Width: =Parent.Width * 0.13
                                    X: =Parent.Width * 0.85
                        - Report.Table.Gallery:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              Height: =Parent.Height * 0.92
                              Items: =varFilteredData
                              TemplatePadding: =1
                              TemplateSize: =Parent.Height * 0.08
                              Width: =Parent.Width
                              Y: =Parent.Height * 0.08
                            Children:
                              - Table.Row.Background:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    BorderColor: =Colors.BorderLight
                                    BorderThickness: =1
                                    Fill: =If(Mod(ThisItem.Id, 2) = 0, Colors.White, Colors.BackgroundLight)
                                    Height: =Parent.TemplateHeight
                                    Width: =Parent.Width
                              - Row.RequestCode:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    Height: =Parent.Height * 0.8
                                    Size: =FontSizes.Small
                                    Text: =ThisItem.RequestCode
                                    Width: =Parent.Width * 0.1
                                    X: =Parent.Width * 0.02
                                    Y: =Parent.Height * 0.1
                              - Row.Employee:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    Height: =Parent.Height * 0.8
                                    Size: =FontSizes.Small
                                    Text: =ThisItem.EmployeeName
                                    Width: =Parent.Width * 0.15
                                    X: =Parent.Width * 0.12
                                    Y: =Parent.Height * 0.1
                              - Row.Department:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    Height: =Parent.Height * 0.8
                                    Size: =FontSizes.Small
                                    Text: =ThisItem.Department
                                    Width: =Parent.Width * 0.18
                                    X: =Parent.Width * 0.27
                                    Y: =Parent.Height * 0.1
                              - Row.CardType:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    Height: =Parent.Height * 0.8
                                    Size: =FontSizes.Small
                                    Text: =ThisItem.CardType
                                    Width: =Parent.Width * 0.1
                                    X: =Parent.Width * 0.45
                                    Y: =Parent.Height * 0.1
                              - Row.RequestDate:
                                  Control: Label@2.5.1
                                  Properties:
                                    Color: =Colors.TextPrimary
                                    Height: =Parent.Height * 0.8
                                    Size: =FontSizes.Small
                                    Text: =Text(ThisItem.RequestDate, "dd/mm/yyyy")
                                    Width: =Parent.Width * 0.1
                                    X: =Parent.Width * 0.55
                                    Y: =Parent.Height * 0.1
                              - Row.Status:
                                  Control: GroupContainer@1.3.0
                                  Variant: ManualLayout
                                  Properties:
                                    BorderColor: |
                                      =Switch(ThisItem.Status,
                                        "Approved", StatusColors.Approved,
                                        "Rejected", StatusColors.Rejected,
                                        "PendingManagerApproval", StatusColors.Pending,
                                        "PendingHRApproval", StatusColors.InProgress,
                                        Colors.Border
                                      )
                                    BorderThickness: =1
                                    Fill: |
                                      =Switch(ThisItem.Status,
                                        "Approved", StatusColors.ApprovedBg,
                                        "Rejected", StatusColors.RejectedBg,
                                        "PendingManagerApproval", StatusColors.PendingBg,
                                        "PendingHRApproval", StatusColors.InProgressBg,
                                        Colors.BorderLight
                                      )
                                    Height: =Parent.Height * 0.6
                                    Width: =Parent.Width * 0.11
                                    X: =Parent.Width * 0.65
                                    Y: =Parent.Height * 0.2
                                  Children:
                                    - Status.Text_2:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: |
                                            =Switch(ThisItem.Status,
                                              "Approved", StatusColors.ApprovedText,
                                              "Rejected", StatusColors.RejectedText,
                                              "PendingManagerApproval", StatusColors.PendingText,
                                              "PendingHRApproval", StatusColors.InProgressText,
                                              Colors.TextMuted
                                            )
                                          FontWeight: =FontWeight.Semibold
                                          Height: =Parent.Height
                                          Size: =FontSizes.Small
                                          Text: |
                                            =Switch(ThisItem.Status,
                                              "Approved", "Đã duyệt",
                                              "Rejected", "Từ chối",
                                              "PendingManagerApproval", "Chờ Manager",
                                              "PendingHRApproval", "Chờ HR",
                                              "Không rõ"
                                            )
                                          Width: =Parent.Width
                              - Row.Priority:
                                  Control: GroupContainer@1.3.0
                                  Variant: ManualLayout
                                  Properties:
                                    BorderColor: =Colors.Border
                                    BorderThickness: =1
                                    Fill: |
                                      =Switch(ThisItem.Priority,
                                        "High", Colors.Error,
                                        "Normal", Colors.Info,
                                        "Low", Colors.TextMuted,
                                        Colors.Border
                                      )
                                    Height: =Parent.Height * 0.6
                                    Width: =Parent.Width * 0.07
                                    X: =Parent.Width * 0.77
                                    Y: =Parent.Height * 0.2
                                  Children:
                                    - Priority.Text_2:
                                        Control: Label@2.5.1
                                        Properties:
                                          Align: =Align.Center
                                          Color: =Colors.White
                                          FontWeight: =FontWeight.Semibold
                                          Height: =Parent.Height
                                          Size: =FontSizes.Small
                                          Text: |
                                            =Switch(ThisItem.Priority,
                                              "High", "Cao",
                                              "Normal", "TB",
                                              "Low", "Thấp",
                                              "TB"
                                            )
                                          Width: =Parent.Width
                              - Row.Cost:
                                  Control: Label@2.5.1
                                  Properties:
                                    Align: =Align.Right
                                    Color: =Colors.TextPrimary
                                    Height: =Parent.Height * 0.8
                                    Size: =FontSizes.Small
                                    Text: =Text(ThisItem.Cost, "#,##0")
                                    Width: =Parent.Width * 0.13
                                    X: =Parent.Width * 0.85
                                    Y: =Parent.Height * 0.1
                        - DataTable1:
                            Control: DataTable@1.0.3
                            Properties:
                              BorderColor: =RGBA(0, 0, 0, 0)
                              Color: =RGBA(50, 49, 48, 1)
                              Font: =Font.'Segoe UI'
                              HeadingColor: =RGBA(255, 255, 255, 1)
                              HeadingFill: =RGBA(0, 120, 212, 1)
                              HeadingFont: =Font.'Segoe UI'
                              Height: =379.10400000000004
                              HoverColor: =RGBA(255, 255, 255, 1)
                              HoverFill: =RGBA(0, 120, 212, 1)
                              Items: =NamecardRequest_1
                              SelectedColor: =RGBA(50, 49, 48, 1)
                              SelectedFill: =RGBA(199, 224, 244, 1)
                              Width: =1079.36
                            Children:
                              - quantity_Column1:
                                  Control: DataTableColumn@1.0.1
                                  Variant: Number
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="quantity"
                                    FieldName: ="quantity"
                                    Order: =1
                                    Text: =ThisItem.quantity
                              - suggestedReason_Column1:
                                  Control: DataTableColumn@1.0.1
                                  Variant: Textual
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="suggestedReason"
                                    FieldName: ="suggestedReason"
                                    Order: =2
                                    Text: =ThisItem.suggestedReason
                              - note_Column1:
                                  Control: DataTableColumn@1.0.1
                                  Variant: Textual
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="note"
                                    FieldName: ="note"
                                    Order: =3
                                    Text: =ThisItem.note
                              - status_Column1:
                                  Control: DataTableColumn@1.0.1
                                  Variant: Textual
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="status"
                                    FieldName: ="status"
                                    Order: =4
                                    Text: =ThisItem.status.Value
                              - printNote_Column1:
                                  Control: DataTableColumn@1.0.1
                                  Variant: Textual
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="printNote"
                                    FieldName: ="printNote"
                                    Order: =5
                                    Text: =ThisItem.printNote
                              - ID_Column1:
                                  Control: DataTableColumn@1.0.1
                                  Variant: Number
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="ID"
                                    FieldName: ="ID"
                                    Order: =6
                                    Text: =ThisItem.ID
                              - Created_Column1:
                                  Control: DataTableColumn@1.0.1
                                  Variant: DateTime
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="Created"
                                    FieldName: ="Created"
                                    Order: =7
                                    Text: =Text(ThisItem.Created,DateTimeFormat.LongDateTime)
                              - Modified_Column1:
                                  Control: DataTableColumn@1.0.1
                                  Variant: DateTime
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="Modified"
                                    FieldName: ="Modified"
                                    Order: =8
                                    Text: =Text(ThisItem.Modified,DateTimeFormat.LongDateTime)
                              - Created By_Column1:
                                  Control: DataTableColumn@1.0.1
                                  Variant: Textual
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="Created By"
                                    FieldName: ="Author"
                                    Order: =9
                                    Text: =ThisItem.'Created By'.DisplayName
                              - Modified By_Column1:
                                  Control: DataTableColumn@1.0.1
                                  Variant: Textual
                                  IsLocked: true
                                  Properties:
                                    FieldDisplayName: ="Modified By"
                                    FieldName: ="Editor"
                                    Order: =10
                                    Text: =ThisItem.'Modified By'.DisplayName
                  - Column.Chart.Container:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =Colors.White
                        Height: =Parent.Height * 0.96
                        Visible: =varReportViewType = "ColumnChart"
                        Width: =Parent.Width * 0.96
                        X: =Parent.Width * 0.02
                        Y: =Parent.Height * 0.02
                      Children:
                        - Chart.Title:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Bold
                              Height: =Parent.Height * 0.08
                              Size: =FontSizes.Medium
                              Text: ="Biểu đồ thống kê yêu cầu thẻ tên theo trạng thái"
                              Width: =Parent.Width
                              Y: =Parent.Height * 0.02
                        - Chart.Info:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =Colors.TextMuted
                              Height: =Parent.Height * 0.7
                              Size: =FontSizes.Base
                              Text: ="Biểu đồ cột hiển thị phân bố yêu cầu theo trạng thái phê duyệt. Dữ liệu được lọc theo các tiêu chí đã chọn ở trên."
                              Width: =Parent.Width * 0.8
                              X: =Parent.Width * 0.1
                              Y: =Parent.Height * 0.15
                  - Pie.Chart.Container:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =Colors.White
                        Height: =Parent.Height * 0.96
                        Visible: =varReportViewType = "PieChart"
                        Width: =Parent.Width * 0.96
                        X: =Parent.Width * 0.02
                        Y: =Parent.Height * 0.02
                      Children:
                        - Pie.Chart.Title:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Bold
                              Height: =Parent.Height * 0.08
                              Size: =FontSizes.Medium
                              Text: ="Biểu đồ tròn phân bố yêu cầu theo phòng ban"
                              Width: =Parent.Width
                              Y: =Parent.Height * 0.02
                        - Pie.Chart.Info:
                            Control: Label@2.5.1
                            Properties:
                              Align: =Align.Center
                              Color: =Colors.TextMuted
                              Height: =Parent.Height * 0.7
                              Size: =FontSizes.Base
                              Text: ="Biểu đồ tròn hiển thị tỷ lệ phân bố yêu cầu thẻ tên theo từng phòng ban. Dữ liệu được tính dựa trên bộ lọc hiện tại."
                              Width: =Parent.Width * 0.8
                              X: =Parent.Width * 0.1
                              Y: =Parent.Height * 0.15
            - Page.Header.Section_2:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.White
                  Height: =Parent.Height * 0.12
                  Width: =Parent.Width
                Children:
                  - Page.Title_2:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.TextPrimary
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height * 0.35
                        Size: =FontSizes.XLarge
                        Text: ="Báo cáo yêu cầu thẻ tên"
                        Width: =Parent.Width * 0.4
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.15
                  - Page.Subtitle_2:
                      Control: Label@2.5.1
                      Properties:
                        Color: =Colors.TextMuted
                        Height: =Parent.Height * 0.35
                        Size: =FontSizes.Base
                        Text: ="Thống kê và phân tích dữ liệu yêu cầu thẻ tên"
                        Width: =Parent.Width * 0.4
                        X: =Parent.Width * 0.03
                        Y: =Parent.Height * 0.5
                  - Export.Current.Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =If(varExportingPDF, Colors.Success, Colors.Success)
                        BorderThickness: =If(varExportingPDF, 2, 1)
                        Color: =Styles.Button.Success.Color
                        DisplayMode: =If(varExportingPDF, DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =If(varExportingPDF, ColorFade(Styles.Button.Success.Fill, 30%), Styles.Button.Success.Fill)
                        Height: =Styles.Button.Height
                        HoverFill: =If(varExportingPDF, Styles.Button.Success.Fill, ColorFade(Styles.Button.Success.HoverFill, -5%))
                        OnSelect: |
                          =Set(varExportingPDF, true);
                          Notify("Đang xuất báo cáo PDF...", NotificationType.Information);
                          Set(varExportedPDFCount, Rand() * 50 + 100);
                          Set(varExportingPDF, false);
                          Notify("Đã xuất báo cáo PDF thành công! Tổng: " & Text(Round(varExportedPDFCount, 0)) & " trang", NotificationType.Success)
                        PressedFill: =ColorFade(Styles.Button.Success.Fill, -10%)
                        Size: =FontSizes.Small
                        Text: =If(varExportingPDF, "Đang xuất PDF...", "Xuất báo cáo (PDF)")
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width - Parent.Width * 0.35
                        Y: =Parent.Height * 0.15
                  - Export.All.Button:
                      Control: Classic/Button@2.2.0
                      Properties:
                        BorderColor: =If(varExportingCSV, Colors.Primary, Colors.Border)
                        BorderThickness: =If(varExportingCSV, 2, 1)
                        Color: =Styles.Button.Secondary.Color
                        DisplayMode: =If(varExportingCSV, DisplayMode.Disabled, DisplayMode.Edit)
                        Fill: =If(varExportingCSV, ColorFade(Styles.Button.Secondary.Fill, 20%), Styles.Button.Secondary.Fill)
                        Height: =Styles.Button.Height
                        HoverFill: =If(varExportingCSV, Styles.Button.Secondary.Fill, ColorFade(Styles.Button.Secondary.HoverFill, -5%))
                        OnSelect: |
                          =Set(varExportingCSV, true);
                          Notify("Đang xuất dữ liệu CSV...", NotificationType.Information);
                          Set(varExportedCSVCount, Rand() * 1000 + 500);
                          Set(varExportingCSV, false);
                          Notify("Đã xuất dữ liệu CSV thành công! Tổng: " & Text(Round(varExportedCSVCount, 0)) & " bản ghi", NotificationType.Success)
                        PressedFill: =ColorFade(Styles.Button.Secondary.Fill, 15%)
                        Size: =FontSizes.Small
                        Text: =If(varExportingCSV, "Đang xuất CSV...", "Xuất tất cả (CSV)")
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width - Parent.Width * 0.18
                        Y: =Parent.Height * 0.15
            - Report.Stats.Section:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.BackgroundLight
                  Height: =Parent.Height * 0.18
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.12
                Children:
                  - Total.Requests.Card_2:
                      Control: CanvasComponent
                      ComponentName: StatsCardComponent
                      Properties:
                        BorderColor: =Colors.Primary
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height * 0.8
                        IsClickable: =false
                        IsLoading: =false
                        Title: ="Tổng yêu cầu"
                        Value: =Text(reportStats.TotalRequests)
                        ValueColor: =Colors.Primary
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width * 0.02
                        Y: =Parent.Height * 0.1
                  - Approved.Requests.Card_2:
                      Control: CanvasComponent
                      ComponentName: StatsCardComponent
                      Properties:
                        BorderColor: =Colors.Success
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height * 0.8
                        IsClickable: =false
                        IsLoading: =false
                        Title: ="Đã duyệt"
                        Value: =Text(reportStats.ApprovedRequests)
                        ValueColor: =Colors.Success
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width * 0.18
                        Y: =Parent.Height * 0.1
                  - Pending.Requests.Card_1:
                      Control: CanvasComponent
                      ComponentName: StatsCardComponent
                      Properties:
                        BorderColor: =Colors.Warning
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height * 0.8
                        IsClickable: =false
                        IsLoading: =false
                        Title: ="Chờ duyệt"
                        Value: =Text(reportStats.PendingRequests)
                        ValueColor: =Colors.Warning
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width * 0.34
                        Y: =Parent.Height * 0.1
                  - Rejected.Requests.Card_2:
                      Control: CanvasComponent
                      ComponentName: StatsCardComponent
                      Properties:
                        BorderColor: =Colors.Error
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height * 0.8
                        IsClickable: =false
                        IsLoading: =false
                        Title: ="Bị từ chối"
                        Value: =Text(reportStats.RejectedRequests)
                        ValueColor: =Colors.Error
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width * 0.5
                        Y: =Parent.Height * 0.1
                  - Total.Cost.Card:
                      Control: CanvasComponent
                      ComponentName: StatsCardComponent
                      Properties:
                        BorderColor: =Colors.Info
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height * 0.8
                        IsClickable: =false
                        IsLoading: =false
                        Title: ="Tổng chi phí"
                        Value: =Text(reportStats.TotalCost / 1000, "0.0") & "K VND"
                        ValueColor: =Colors.Info
                        Width: =Parent.Width * 0.16
                        X: =Parent.Width * 0.66
                        Y: =Parent.Height * 0.1
                  - Avg.Processing.Card:
                      Control: CanvasComponent
                      ComponentName: StatsCardComponent
                      Properties:
                        BorderColor: =Colors.TextMuted
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height * 0.8
                        IsClickable: =false
                        IsLoading: =false
                        Title: ="TB xử lý"
                        Value: =Text(Round(reportStats.AverageProcessingDays, 1)) & " ngày"
                        ValueColor: =Colors.TextMuted
                        Width: =Parent.Width * 0.15
                        X: =Parent.Width * 0.83
                        Y: =Parent.Height * 0.1
            - Filters.ViewOptions.Section:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =Colors.White
                  Height: =Parent.Height * 0.15
                  Width: =Parent.Width
                  Y: =Parent.Height * 0.3
                Children:
                  - Filters.Row1.Container:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =Colors.White
                        Height: =Parent.Height * 0.6
                        Width: =Parent.Width
                      Children:
                        - Filters.Title_1:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Bold
                              Height: =Parent.Height * 0.35
                              Size: =FontSizes.Medium
                              Text: ="Bộ lọc dữ liệu"
                              Width: =Parent.Width * 0.15
                              X: =Parent.Width * 0.03
                              Y: =Parent.Height * 0.1
                        - Month.Filter:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Colors.Border
                              DefaultSelectedItems: |
                                =Filter(Table({Name: "Tất cả", Value: "All"}, {Name: "Tháng " & Text(Month(Today())), Value: Text(Month(Today()), "00")}), Value = varFilterMonth)
                              Fill: =Colors.White
                              Height: =Styles.Input.Height
                              Items: |
                                =Table(
                                {Name: "Tất cả", Value: "All"},
                                {Name: "Tháng 1", Value: "01"}, {Name: "Tháng 2", Value: "02"},
                                {Name: "Tháng 3", Value: "03"}, {Name: "Tháng 4", Value: "04"},
                                {Name: "Tháng 5", Value: "05"}, {Name: "Tháng 6", Value: "06"},
                                {Name: "Tháng 7", Value: "07"}, {Name: "Tháng 8", Value: "08"},
                                {Name: "Tháng 9", Value: "09"}, {Name: "Tháng 10", Value: "10"},
                                {Name: "Tháng 11", Value: "11"}, {Name: "Tháng 12", Value: "12"}
                                )
                              OnChange: |
                                =Set(varFilterMonth, Self.Selected.Result.Value);
                                Set(varFilteredData, Filter(colReportData,
                                  And(
                                    Or(varFilterMonth = "All", Text(RequestDate, "mm") = varFilterMonth),
                                    Or(varFilterYear = "All", Text(RequestDate, "yyyy") = varFilterYear),
                                    Or(varFilterDepartment = "All", Department = varFilterDepartment),
                                    Or(varFilterStatus = "All", Status = varFilterStatus),
                                    Or(varFilterPriority = "All", Priority = varFilterPriority),
                                    RequestDate >= varDateFrom,
                                    RequestDate <= varDateTo
                                  )
                                ))
                              Width: =Parent.Width * 0.08
                              X: =Parent.Width * 0.03
                              Y: =Parent.Height * 0.5
                        - Year.Filter:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Colors.Border
                              DefaultSelectedItems: |
                                =Table({Name: Text(Year(Today())), Value: Text(Year(Today()))})
                              Fill: =Colors.White
                              Height: =Styles.Input.Height
                              Items: |
                                =Table(
                                {Name: "Tất cả", Value: "All"},
                                {Name: "2024", Value: "2024"},
                                {Name: "2023", Value: "2023"},
                                {Name: "2022", Value: "2022"}
                                )
                              OnChange: |
                                =Set(varFilterYear, Self.Selected.Result.Value);
                                Set(varFilteredData, Filter(colReportData,
                                  And(
                                    Or(varFilterMonth = "All", Text(RequestDate, "mm") = varFilterMonth),
                                    Or(varFilterYear = "All", Text(RequestDate, "yyyy") = varFilterYear),
                                    Or(varFilterDepartment = "All", Department = varFilterDepartment),
                                    Or(varFilterStatus = "All", Status = varFilterStatus),
                                    Or(varFilterPriority = "All", Priority = varFilterPriority),
                                    RequestDate >= varDateFrom,
                                    RequestDate <= varDateTo
                                  )
                                ))
                              Width: =Parent.Width * 0.08
                              X: =Parent.Width * 0.12
                              Y: =Parent.Height * 0.5
                        - Department.Filter:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Colors.Border
                              DefaultSelectedItems: |
                                =Table({Name: "Tất cả", Value: "All"})
                              Fill: =Colors.White
                              Height: =Styles.Input.Height
                              Items: |
                                =Table(
                                {Name: "Tất cả", Value: "All"},
                                {Name: "Phòng Công nghệ thông tin", Value: "Phòng Công nghệ thông tin"},
                                {Name: "Phòng Nhân sự", Value: "Phòng Nhân sự"},
                                {Name: "Phòng Kế toán", Value: "Phòng Kế toán"},
                                {Name: "Phòng Marketing", Value: "Phòng Marketing"}
                                )
                              OnChange: |
                                =Set(varFilterDepartment, Self.Selected.Result.Value);
                                Set(varFilteredData, Filter(colReportData,
                                  And(
                                    Or(varFilterMonth = "All", Text(RequestDate, "mm") = varFilterMonth),
                                    Or(varFilterYear = "All", Text(RequestDate, "yyyy") = varFilterYear),
                                    Or(varFilterDepartment = "All", Department = varFilterDepartment),
                                    Or(varFilterStatus = "All", Status = varFilterStatus),
                                    Or(varFilterPriority = "All", Priority = varFilterPriority),
                                    RequestDate >= varDateFrom,
                                    RequestDate <= varDateTo
                                  )
                                ))
                              Width: =Parent.Width * 0.15
                              X: =Parent.Width * 0.21
                              Y: =Parent.Height * 0.5
                        - Status.Filter_2:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Colors.Border
                              DefaultSelectedItems: |
                                =Table({Name: "Tất cả", Value: "All"})
                              Fill: =Colors.White
                              Height: =Styles.Input.Height
                              Items: |
                                =Table(
                                {Name: "Tất cả", Value: "All"},
                                {Name: "Đã duyệt", Value: "Approved"},
                                {Name: "Chờ duyệt", Value: "Pending"},
                                {Name: "Bị từ chối", Value: "Rejected"}
                                )
                              OnChange: |
                                =Set(varFilterStatus, Self.Selected.Result.Value);
                                Set(varFilteredData, Filter(colReportData,
                                  And(
                                    Or(varFilterMonth = "All", Text(RequestDate, "mm") = varFilterMonth),
                                    Or(varFilterYear = "All", Text(RequestDate, "yyyy") = varFilterYear),
                                    Or(varFilterDepartment = "All", Department = varFilterDepartment),
                                    Or(varFilterStatus = "All", 
                                       Or(And(varFilterStatus = "Pending", Status in ["PendingManagerApproval", "PendingHRApproval"]), Status = varFilterStatus)),
                                    Or(varFilterPriority = "All", Priority = varFilterPriority),
                                    RequestDate >= varDateFrom,
                                    RequestDate <= varDateTo
                                  )
                                ))
                              Width: =Parent.Width * 0.12
                              X: =Parent.Width * 0.37
                              Y: =Parent.Height * 0.5
                        - Priority.Filter_1:
                            Control: DropDown@0.0.45
                            Properties:
                              BorderColor: =Colors.Border
                              DefaultSelectedItems: |
                                =Table({Name: "Tất cả", Value: "All"})
                              Fill: =Colors.White
                              Height: =Styles.Input.Height
                              Items: |
                                =Table(
                                {Name: "Tất cả", Value: "All"},
                                {Name: "Cao", Value: "High"},
                                {Name: "Thường", Value: "Normal"},
                                {Name: "Thấp", Value: "Low"}
                                )
                              OnChange: |
                                =Set(varFilterPriority, Self.Selected.Result.Value);
                                Set(varFilteredData, Filter(colReportData,
                                  And(
                                    Or(varFilterMonth = "All", Text(RequestDate, "mm") = varFilterMonth),
                                    Or(varFilterYear = "All", Text(RequestDate, "yyyy") = varFilterYear),
                                    Or(varFilterDepartment = "All", Department = varFilterDepartment),
                                    Or(varFilterStatus = "All", Status = varFilterStatus),
                                    Or(varFilterPriority = "All", Priority = varFilterPriority),
                                    RequestDate >= varDateFrom,
                                    RequestDate <= varDateTo
                                  )
                                ))
                              Width: =Parent.Width * 0.1
                              X: =Parent.Width * 0.5
                              Y: =Parent.Height * 0.5
                  - Filters.Row2.Container:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        Fill: =Colors.White
                        Height: =43.07999999999999
                        Width: =Parent.Width
                        Y: =Parent.Height * 0.6
                      Children:
                        - Date.From.Label_1:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              Height: =Parent.Height * 0.8
                              Size: =FontSizes.Small
                              Text: ="Từ ngày:"
                              Width: =Parent.Width * 0.06
                              X: =Parent.Width * 0.03
                              Y: =Parent.Height * 0.1
                        - Date.From.Input_1:
                            Control: Classic/DatePicker@2.6.0
                            Properties:
                              BorderColor: =Colors.Border
                              DefaultDate: =varDateFrom
                              Fill: =Colors.White
                              Height: =Parent.Height * 0.6
                              OnChange: |
                                =Set(varDateFrom, Self.SelectedDate);
                                Set(varFilteredData, Filter(colReportData,
                                  And(
                                    Or(varFilterMonth = "All", Text(RequestDate, "mm") = varFilterMonth),
                                    Or(varFilterYear = "All", Text(RequestDate, "yyyy") = varFilterYear),
                                    Or(varFilterDepartment = "All", Department = varFilterDepartment),
                                    Or(varFilterStatus = "All", Status = varFilterStatus),
                                    Or(varFilterPriority = "All", Priority = varFilterPriority),
                                    RequestDate >= varDateFrom,
                                    RequestDate <= varDateTo
                                  )
                                ))
                              Size: =FontSizes.Small
                              Width: =Parent.Width * 0.1
                              X: =Parent.Width * 0.09
                              Y: =Parent.Height * 0.2
                        - Date.To.Label_1:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              Height: =Parent.Height * 0.8
                              Size: =FontSizes.Small
                              Text: ="Đến ngày:"
                              Width: =Parent.Width * 0.06
                              X: =Parent.Width * 0.2
                              Y: =Parent.Height * 0.1
                        - Date.To.Input_1:
                            Control: Classic/DatePicker@2.6.0
                            Properties:
                              BorderColor: =Colors.Border
                              DefaultDate: =varDateTo
                              Fill: =Colors.White
                              Height: =Parent.Height * 0.6
                              OnChange: |
                                =Set(varDateTo, Self.SelectedDate);
                                Set(varFilteredData, Filter(colReportData,
                                  And(
                                    Or(varFilterMonth = "All", Text(RequestDate, "mm") = varFilterMonth),
                                    Or(varFilterYear = "All", Text(RequestDate, "yyyy") = varFilterYear),
                                    Or(varFilterDepartment = "All", Department = varFilterDepartment),
                                    Or(varFilterStatus = "All", Status = varFilterStatus),
                                    Or(varFilterPriority = "All", Priority = varFilterPriority),
                                    RequestDate >= varDateFrom,
                                    RequestDate <= varDateTo
                                  )
                                ))
                              Size: =FontSizes.Small
                              Width: =Parent.Width * 0.1
                              X: =Parent.Width * 0.26
                              Y: =Parent.Height * 0.2
                        - Clear.Filters.Button_1:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =Colors.Border
                              Color: =Styles.Button.Secondary.Color
                              Fill: =Styles.Button.Secondary.Fill
                              Height: =Parent.Height * 0.6
                              HoverFill: =Styles.Button.Secondary.HoverFill
                              OnSelect: |
                                =Reset('Month.Filter');
                                Reset('Year.Filter');
                                Reset('Department.Filter');
                                Reset('Status.Filter_2');
                                Reset('Priority.Filter_1');
                                Set(varFilterMonth, "All");
                                Set(varFilterYear, "All");
                                Set(varFilterDepartment, "All");
                                Set(varFilterStatus, "All");
                                Set(varFilterPriority, "All");
                                Set(varDateFrom, DateAdd(Today(), -30, Days));
                                Set(varDateTo, Today());
                                Set(varFilteredData, colReportData)
                              Size: =FontSizes.Small
                              Text: ="Xóa bộ lọc"
                              Width: =Parent.Width * 0.1
                              X: =Parent.Width * 0.38
                              Y: =Parent.Height * 0.2
                        - View.Type.Label:
                            Control: Label@2.5.1
                            Properties:
                              Color: =Colors.TextPrimary
                              FontWeight: =FontWeight.Semibold
                              Height: =Parent.Height * 0.8
                              Size: =FontSizes.Small
                              Text: ="Loại hiển thị:"
                              Width: =Parent.Width * 0.1
                              X: =Parent.Width * 0.55
                              Y: =Parent.Height * 0.1
                        - Table.View.Button:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =If(varReportViewType = "Table", Colors.Primary, Colors.Border)
                              Color: =If(varReportViewType = "Table", Styles.Button.Primary.Color, Styles.Button.Secondary.Color)
                              Fill: =If(varReportViewType = "Table", Styles.Button.Primary.Fill, Styles.Button.Secondary.Fill)
                              Height: =Parent.Height * 0.6
                              HoverFill: =If(varReportViewType = "Table", Styles.Button.Primary.HoverFill, Styles.Button.Secondary.HoverFill)
                              OnSelect: |
                                =Set(varReportViewType, "Table")
                              Size: =FontSizes.Small
                              Text: ="Bảng"
                              Width: =Parent.Width * 0.08
                              X: =Parent.Width * 0.65
                              Y: =Parent.Height * 0.2
                        - Chart.View.Button:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =If(varReportViewType = "ColumnChart", Colors.Primary, Colors.Border)
                              Color: =If(varReportViewType = "ColumnChart", Styles.Button.Primary.Color, Styles.Button.Secondary.Color)
                              Fill: =If(varReportViewType = "ColumnChart", Styles.Button.Primary.Fill, Styles.Button.Secondary.Fill)
                              Height: =Parent.Height * 0.6
                              HoverFill: =If(varReportViewType = "ColumnChart", Styles.Button.Primary.HoverFill, Styles.Button.Secondary.HoverFill)
                              OnSelect: |
                                =Set(varReportViewType, "ColumnChart")
                              Size: =FontSizes.Small
                              Text: ="Biểu đồ cột"
                              Width: =Parent.Width * 0.1
                              X: =Parent.Width * 0.74
                              Y: =Parent.Height * 0.2
                        - Pie.Chart.View.Button:
                            Control: Classic/Button@2.2.0
                            Properties:
                              BorderColor: =If(varReportViewType = "PieChart", Colors.Primary, Colors.Border)
                              Color: =If(varReportViewType = "PieChart", Styles.Button.Primary.Color, Styles.Button.Secondary.Color)
                              Fill: =If(varReportViewType = "PieChart", Styles.Button.Primary.Fill, Styles.Button.Secondary.Fill)
                              Height: =Parent.Height * 0.6
                              HoverFill: =If(varReportViewType = "PieChart", Styles.Button.Primary.HoverFill, Styles.Button.Secondary.HoverFill)
                              OnSelect: |
                                =Set(varReportViewType, "PieChart")
                              Size: =FontSizes.Small
                              Text: ="Biểu đồ tròn"
                              Width: =Parent.Width * 0.12
                              X: =Parent.Width * 0.85
                              Y: =Parent.Height * 0.2
      - Loading.Overlay:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            Fill: =RGBA(255, 255, 255, 0.8)
            Height: =Parent.Height
            Visible: =Or(varExportingPDF, varExportingCSV)
            Width: =Parent.Width
          Children:
            - Loading.Container:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  BorderColor: =Colors.Border
                  BorderThickness: =2
                  Fill: =Colors.White
                  Height: =Parent.Height * 0.2
                  Width: =Parent.Width * 0.3
                  X: =(Parent.Width - Parent.Width * 0.3) / 2
                  Y: =(Parent.Height - Parent.Height * 0.2) / 2
                Children:
                  - Loading.Spinner:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        Color: =Colors.Primary
                        Height: =40
                        Icon: =Icon.Sync
                        Width: =40
                        X: =(Parent.Width - 40) / 2
                        Y: =Parent.Height * 0.2
                  - Loading.Text:
                      Control: Label@2.5.1
                      Properties:
                        Align: =Align.Center
                        Color: =Colors.TextPrimary
                        Height: =Parent.Height * 0.25
                        Size: =FontSizes.Base
                        Text: =If(varExportingPDF, "Đang xuất báo cáo PDF...", "Đang xuất dữ liệu CSV...")
                        Width: =Parent.Width
                        Y: =Parent.Height * 0.7
